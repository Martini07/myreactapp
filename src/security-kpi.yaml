dashboards:
 security-kpi:
    dependsOn:
      datasets:
      - kpi_guardduty
      - kpi_patching
      - kpi_waf
    name: Security KPI Dashboard
    dashboardId: security-kpi
    data: |-
      AnalysisDefaults:
        DefaultNewSheetConfiguration:
          InteractiveLayoutConfiguration:
            Grid:
              CanvasSizeOptions:
                ScreenCanvasSizeOptions:
                  OptimizedViewPortWidth: 1600px
                  ResizeOption: FIXED
          SheetContentType: INTERACTIVE
      CalculatedFields:
      - DataSetIdentifier: kpi_guardduty
        Expression: '''Goals'''
        Name: Goals
      - DataSetIdentifier: kpi_guardduty
        Expression: ifelse(contains(type, "Backdoor:EC2/DenialOfService.Dns"), 1, 0)
        Name: _EC2DenialOfServiceDns
      - DataSetIdentifier: kpi_guardduty
        Expression: sum({_EC2DenialOfServiceDns})
        Name: _EC2DenialOfServiceDnsCount
      - DataSetIdentifier: kpi_guardduty
        Expression: max(${EC2DenialOfServiceDnsGoal})
        Name: _EC2DenialOfServiceDnsGoal
      - DataSetIdentifier: kpi_guardduty
        Expression: '{_EC2DenialOfServiceDnsCount} - {_EC2DenialOfServiceDnsGoal}'
        Name: _EC2DenialOfServiceDnsTrend
      - DataSetIdentifier: kpi_guardduty
        Expression: ifelse(contains(type, "Backdoor:EC2/DenialOfService.Tcp"), 1, 0)
        Name: _EC2DenialOfServiceTcp
      - DataSetIdentifier: kpi_guardduty
        Expression: sum({_EC2DenialOfServiceTcp})
        Name: _EC2DenialOfServiceTcpCount
      - DataSetIdentifier: kpi_guardduty
        Expression: max(${EC2DenialOfServiceTcpGoal})
        Name: _EC2DenialOfServiceTcpGoal
      - DataSetIdentifier: kpi_guardduty
        Expression: '{_EC2DenialOfServiceTcpCount} - {_EC2DenialOfServiceTcpGoal}'
        Name: _EC2DenialOfServiceTcpTrend
      - DataSetIdentifier: kpi_guardduty
        Expression: ifelse(contains(type, "Backdoor:EC2/DenialOfService.Udp"), 1, 0)
        Name: _EC2DenialOfServiceUdp
      - DataSetIdentifier: kpi_guardduty
        Expression: sum({_EC2DenialOfServiceUdp})
        Name: _EC2DenialOfServiceUdpCount
      - DataSetIdentifier: kpi_guardduty
        Expression: max(${EC2DenialOfServiceUdpGoal})
        Name: _EC2DenialOfServiceUdpGoal
      - DataSetIdentifier: kpi_guardduty
        Expression: ifelse(contains(type, "Backdoor:EC2/DenialOfService.UdpOnTcpPorts"),
          1, 0)
        Name: _EC2DenialOfServiceUdpOnTcpPorts
      - DataSetIdentifier: kpi_guardduty
        Expression: sum({_EC2DenialOfServiceUdpOnTcpPorts})
        Name: _EC2DenialOfServiceUdpOnTcpPortsCount
      - DataSetIdentifier: kpi_guardduty
        Expression: max(${EC2DenialOfServiceUdpOnTcpPortsGoal})
        Name: _EC2DenialOfServiceUdpOnTcpPortsGoal
      - DataSetIdentifier: kpi_guardduty
        Expression: '{_EC2DenialOfServiceUdpOnTcpPortsCount} - {_EC2DenialOfServiceUdpOnTcpPortsGoal}'
        Name: _EC2DenialOfServiceUdpOnTcpPortsTrend
      - DataSetIdentifier: kpi_guardduty
        Expression: '{_EC2DenialOfServiceUdpCount} - {_EC2DenialOfServiceUdpGoal}'
        Name: _EC2DenialOfServiceUdpTrend
      - DataSetIdentifier: kpi_guardduty
        Expression: ifelse(contains(type, "Backdoor:EC2/DenialOfService.UnusualProtocol"),
          1, 0)
        Name: _EC2DenialOfServiceUnusualProtocol
      - DataSetIdentifier: kpi_guardduty
        Expression: sum({_EC2DenialOfServiceUnusualProtocol})
        Name: _EC2DenialOfServiceUnusualProtocolCount
      - DataSetIdentifier: kpi_guardduty
        Expression: max(${EC2DenialOfServiceUnusualProtocolGoal})
        Name: _EC2DenialOfServiceUnusualProtocolGoal
      - DataSetIdentifier: kpi_guardduty
        Expression: '{_EC2DenialOfServiceUnusualProtocolCount} - {_EC2DenialOfServiceUnusualProtocolGoal}'
        Name: _EC2DenialOfServiceUnusualProtocolTrend
      - DataSetIdentifier: kpi_guardduty
        Expression: ifelse(contains(type, "Behavior:EC2/TrafficVolumeUnusual"), 1, 0)
        Name: _EC2TrafficVolumeUnusual
      - DataSetIdentifier: kpi_guardduty
        Expression: sum({_EC2TrafficVolumeUnusual})
        Name: _EC2TrafficVolumeUnusualCount
      - DataSetIdentifier: kpi_guardduty
        Expression: max(${EC2TrafficVolumeUnusualGoal})
        Name: _EC2TrafficVolumeUnusualGoal
      - DataSetIdentifier: kpi_guardduty
        Expression: '{_EC2TrafficVolumeUnusualCount} - {_EC2TrafficVolumeUnusualGoal}'
        Name: _EC2TrafficVolumeUnusualTrend
      - DataSetIdentifier: kpi_guardduty
        Expression: ifelse(contains(type, "CredentialAccess:RDS/AnomalousBehavior.SuccessfulBruteForce"),
          1, 0)
        Name: _RDSAnomalousBehaviorSuccessfulBruteForce
      - DataSetIdentifier: kpi_guardduty
        Expression: sum({_RDSAnomalousBehaviorSuccessfulBruteForce})
        Name: _RDSAnomalousBehaviorSuccessfulBruteForceCount
      - DataSetIdentifier: kpi_guardduty
        Expression: max(${RDSAnomalousBehaviorSuccessfulBruteForceGoal})
        Name: _RDSAnomalousBehaviorSuccessfulBruteForceGoal
      - DataSetIdentifier: kpi_guardduty
        Expression: '{_RDSAnomalousBehaviorSuccessfulBruteForceCount} - {_RDSAnomalousBehaviorSuccessfulBruteForceGoal}'
        Name: _RDSAnomalousBehaviorSuccessfulBruteForceTrend
      - DataSetIdentifier: kpi_guardduty
        Expression: ifelse(contains(type, "Exfiltration:S3/AnomalousBehavior"), 1, 0)
        Name: _S3AnomalousBehavior
      - DataSetIdentifier: kpi_guardduty
        Expression: sum({_S3AnomalousBehavior})
        Name: _S3AnomalousBehaviorCount
      - DataSetIdentifier: kpi_guardduty
        Expression: max(${S3AnomalousBehaviorGoal})
        Name: _S3AnomalousBehaviorGoal
      - DataSetIdentifier: kpi_guardduty
        Expression: '{_S3AnomalousBehaviorCount} - {_S3AnomalousBehaviorGoal}'
        Name: _S3AnomalousBehaviorTrend
      - DataSetIdentifier: kpi_guardduty
        Expression: ifelse(contains(type, "Exfiltration:S3/MaliciousIPCaller"), 1, 0)
        Name: _S3MaliciousIPCaller
      - DataSetIdentifier: kpi_guardduty
        Expression: sum({_S3MaliciousIPCaller})
        Name: _S3MaliciousIPCallerCount
      - DataSetIdentifier: kpi_guardduty
        Expression: ifelse(contains(type, "UnauthorizedAccess:S3/MaliciousIPCaller.Custom"),
          1, 0)
        Name: _S3MaliciousIPCallerCustom
      - DataSetIdentifier: kpi_guardduty
        Expression: sum({_S3MaliciousIPCallerCustom})
        Name: _S3MaliciousIPCallerCustomCount
      - DataSetIdentifier: kpi_guardduty
        Expression: max(${S3MaliciousIPCallerCustomGoal})
        Name: _S3MaliciousIPCallerCustomGoal
      - DataSetIdentifier: kpi_guardduty
        Expression: '{_S3MaliciousIPCallerCustomCount} - {_S3MaliciousIPCallerCustomGoal}'
        Name: _S3MaliciousIPCallerCustomTrend
      - DataSetIdentifier: kpi_guardduty
        Expression: max(${S3MaliciousIPCallerGoal})
        Name: _S3MaliciousIPCallerGoal
      - DataSetIdentifier: kpi_guardduty
        Expression: '{_S3MaliciousIPCallerCount} - {_S3MaliciousIPCallerGoal}'
        Name: _S3MaliciousIPCallerTrend
      - DataSetIdentifier: kpi_guardduty
        Expression: ifelse(contains(type, "Policy:IAMUser/RootCredentialUsage"), 1, 0)
        Name: _rootCredentialUsage
      - DataSetIdentifier: kpi_guardduty
        Expression: sum({_rootCredentialUsage})
        Name: _rootCredentialUsageCount
      - DataSetIdentifier: kpi_guardduty
        Expression: max(${RootCredentialUsageGoal})
        Name: _rootCredentialUsageGoal
      - DataSetIdentifier: kpi_guardduty
        Expression: '{_rootCredentialUsageCount} - {_rootCredentialUsageGoal}'
        Name: _rootCredentialUsageTrend
      - DataSetIdentifier: kpi_patching
        Expression: '''Goals'''
        Name: Goals
      - DataSetIdentifier: kpi_patching
        Expression: ifelse(startsWith(toUpper({compliance_status}), "COMPLIANT"), 1, 0)
        Name: _patchingComplianceCount
      - DataSetIdentifier: kpi_patching
        Expression: sum({_patchingComplianceCount})/count({compliance_status})
        Name: _patchingCompliancePercentage
      - DataSetIdentifier: kpi_patching
        Expression: '{_patchingGoal}/{_patchingCompliancePercentage}'
        Name: _patchingComplianceTrend
      - DataSetIdentifier: kpi_patching
        Expression: max(${PatchingGoal})/100
        Name: _patchingGoal
      - DataSetIdentifier: kpi_waf
        Expression: max(${BlockedGoal})/100
        Name: BlockedGoal
      - DataSetIdentifier: kpi_waf
        Expression: SUM(blocked)/(SUM(allowed)+SUM(blocked))
        Name: BlockedPercentage
      - DataSetIdentifier: kpi_waf
        Expression: BlockedGoal/BlockedPercentage
        Name: BlockedTrend
      - DataSetIdentifier: kpi_waf
        Expression: '''Goals'''
        Name: Goals
      - DataSetIdentifier: kpi_waf
        Expression: ifelse(contains(toUpper(action), "ALLOW"), 1, 0)
        Name: allowed
      - DataSetIdentifier: kpi_waf
        Expression: ifelse(contains(toUpper(action), "BLOCK"), 1, 0)
        Name: blocked
      ColumnConfigurations:
      - Column:
          ColumnName: BlockedPercentage
          DataSetIdentifier: kpi_waf
        FormatConfiguration:
          NumberFormatConfiguration:
            FormatConfiguration:
              PercentageDisplayFormatConfiguration:
                NegativeValueConfiguration:
                  DisplayMode: NEGATIVE
                SeparatorConfiguration:
                  DecimalSeparator: DOT
                  ThousandsSeparator:
                    Symbol: COMMA
                    Visibility: VISIBLE
                Suffix: '%'
      - Column:
          ColumnName: BlockedGoal
          DataSetIdentifier: kpi_waf
        FormatConfiguration:
          NumberFormatConfiguration:
            FormatConfiguration:
              PercentageDisplayFormatConfiguration:
                NegativeValueConfiguration:
                  DisplayMode: NEGATIVE
                SeparatorConfiguration:
                  DecimalSeparator: DOT
                  ThousandsSeparator:
                    Symbol: COMMA
                    Visibility: VISIBLE
                Suffix: '%'
      - Column:
          ColumnName: report_date
          DataSetIdentifier: kpi_patching
        FormatConfiguration:
          DateTimeFormatConfiguration: {}
        Role: DIMENSION
      DataSetIdentifierDeclarations:
      - DataSetArn: arn:aws:quicksight:::dataset/453819c8-a7b1-405a-8044-59f2aed066bc
        Identifier: kpi_guardduty
      - DataSetArn: arn:aws:quicksight:::dataset/ffc7b180-72db-4b8d-89b7-2f6690587082
        Identifier: kpi_patching
      - DataSetArn: arn:aws:quicksight:::dataset/4323a7a3-5eeb-42bc-b952-8dc76257c589
        Identifier: kpi_waf
      FilterGroups:
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: e5438c33-f429-4d37-937f-812823220221
        Filters:
        - CategoryFilter:
            Column:
              ColumnName: webaclid
              DataSetIdentifier: kpi_waf
            Configuration:
              FilterListConfiguration:
                MatchOperator: CONTAINS
                SelectAllOptions: FILTER_ALL_VALUES
            FilterId: 96374bfa-6314-4767-95d6-1f877edbe080
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: SELECTED_VISUALS
              SheetId: 658ce5c3-48dc-4dc9-b1ec-f94527699c3d
              VisualIds:
              - 1794e969-cd8c-4475-b6eb-f44dd529b53b
        Status: ENABLED
      - CrossDataset: ALL_DATASETS
        FilterGroupId: 643a5329-cba0-4a5c-b7e7-bf388fadf7b3
        Filters:
        - CategoryFilter:
            Column:
              ColumnName: country
              DataSetIdentifier: kpi_waf
            Configuration:
              FilterListConfiguration:
                MatchOperator: CONTAINS
                SelectAllOptions: FILTER_ALL_VALUES
            FilterId: ccdb9fad-a1e2-4c71-bd8c-30d1d90cc669
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: ALL_VISUALS
              SheetId: 1244e012-61df-4baa-a257-22a1a4c8dbc9
        Status: ENABLED
      - CrossDataset: ALL_DATASETS
        FilterGroupId: df81da7b-e3c3-4316-a10b-18ee0c43ee0a
        Filters:
        - CategoryFilter:
            Column:
              ColumnName: action
              DataSetIdentifier: kpi_waf
            Configuration:
              FilterListConfiguration:
                MatchOperator: CONTAINS
                SelectAllOptions: FILTER_ALL_VALUES
            FilterId: b0b5661c-3da0-4c91-8121-b8503c536e32
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: ALL_VISUALS
              SheetId: 1244e012-61df-4baa-a257-22a1a4c8dbc9
        Status: ENABLED
      - CrossDataset: ALL_DATASETS
        FilterGroupId: fa6d9870-512d-467b-a4eb-b1404e4a181e
        Filters:
        - CategoryFilter:
            Column:
              ColumnName: clientip
              DataSetIdentifier: kpi_waf
            Configuration:
              FilterListConfiguration:
                MatchOperator: CONTAINS
                SelectAllOptions: FILTER_ALL_VALUES
            FilterId: 8fc88e72-45e2-4e87-8234-cb91296e1825
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: ALL_VISUALS
              SheetId: 1244e012-61df-4baa-a257-22a1a4c8dbc9
        Status: ENABLED
      - CrossDataset: ALL_DATASETS
        FilterGroupId: 4aae25ed-cb3c-48ba-bcdf-93a7d0c69d1e
        Filters:
        - TimeRangeFilter:
            Column:
              ColumnName: timestamp
              DataSetIdentifier: kpi_waf
            FilterId: 5655b4bc-aa26-4674-8fa2-b56fbaa19b45
            NullOption: NON_NULLS_ONLY
            RangeMaximumValue:
              StaticValue: 2023-10-31 18:43:00+00:00
            RangeMinimumValue:
              StaticValue: 2023-08-01 18:43:00+00:00
            TimeGranularity: MINUTE
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: ALL_VISUALS
              SheetId: 1244e012-61df-4baa-a257-22a1a4c8dbc9
        Status: ENABLED
      - CrossDataset: ALL_DATASETS
        FilterGroupId: c7810f0e-c9a9-4ce2-9304-110aea8ba726
        Filters:
        - CategoryFilter:
            Column:
              ColumnName: webaclid
              DataSetIdentifier: kpi_waf
            Configuration:
              FilterListConfiguration:
                MatchOperator: CONTAINS
                SelectAllOptions: FILTER_ALL_VALUES
            FilterId: f3206401-0fd4-43d5-99b1-c634612193bb
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: ALL_VISUALS
              SheetId: 1244e012-61df-4baa-a257-22a1a4c8dbc9
        Status: ENABLED
      - CrossDataset: ALL_DATASETS
        FilterGroupId: 5aef5aa7-bfb5-48f3-8120-2c8dc44c8485
        Filters:
        - TimeRangeFilter:
            Column:
              ColumnName: createdat
              DataSetIdentifier: kpi_guardduty
            FilterId: a02083e4-91d0-4f61-b897-2d1162190f16
            IncludeMaximum: false
            IncludeMinimum: false
            NullOption: NON_NULLS_ONLY
            RangeMaximumValue:
              RollingDate:
                Expression: truncDate('DD', now())
            RangeMinimumValue:
              StaticValue: 2023-03-01 00:00:00+00:00
            TimeGranularity: DAY
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: ALL_VISUALS
              SheetId: 0d8daf3f-54a7-44bc-8058-ac19c3a30558
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: cf6e1a4d-860a-4e74-9a46-2fc6c7e41517
        Filters:
        - CategoryFilter:
            Column:
              ColumnName: accountid
              DataSetIdentifier: kpi_guardduty
            Configuration:
              FilterListConfiguration:
                MatchOperator: CONTAINS
                SelectAllOptions: FILTER_ALL_VALUES
            FilterId: 3ef4714e-6a2a-428e-9c6f-58bb414a0981
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: ALL_VISUALS
              SheetId: 0d8daf3f-54a7-44bc-8058-ac19c3a30558
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: 2a96000c-2c59-4ba5-84dd-da6157b54458
        Filters:
        - TimeRangeFilter:
            Column:
              ColumnName: report_date
              DataSetIdentifier: kpi_patching
            FilterId: dd027afa-d3e5-460a-a140-e58cc21f8ee5
            NullOption: NON_NULLS_ONLY
            RangeMaximumValue:
              StaticValue: 2023-10-31 16:41:00+00:00
            RangeMinimumValue:
              StaticValue: 2023-10-01 16:41:00+00:00
            TimeGranularity: MINUTE
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: ALL_VISUALS
              SheetId: a75f7fbe-8ba9-48fc-8e65-4a6556d2a568
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: 4ba9cf58-ada5-484c-9fcd-c5f62cb6bab3
        Filters:
        - CategoryFilter:
            Column:
              ColumnName: account_id
              DataSetIdentifier: kpi_patching
            Configuration:
              FilterListConfiguration:
                MatchOperator: CONTAINS
                SelectAllOptions: FILTER_ALL_VALUES
            FilterId: 3b02be53-4134-4133-9bac-3603b9f822f7
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: ALL_VISUALS
              SheetId: a75f7fbe-8ba9-48fc-8e65-4a6556d2a568
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: 0d5bc0b9-6e63-4998-9b6f-b981e7d2e11d
        Filters:
        - CategoryFilter:
            Column:
              ColumnName: accountid
              DataSetIdentifier: kpi_waf
            Configuration:
              FilterListConfiguration:
                MatchOperator: CONTAINS
                SelectAllOptions: FILTER_ALL_VALUES
            FilterId: 117f533f-7e78-42e2-95af-6ca40763002f
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: ALL_VISUALS
              SheetId: 1244e012-61df-4baa-a257-22a1a4c8dbc9
        Status: ENABLED
      ParameterDeclarations:
      - DecimalParameterDeclaration:
          DefaultValues:
            StaticValues:
            - 10.0
          Name: RootCredentialUsageGoal
          ParameterValueType: SINGLE_VALUED
          ValueWhenUnset:
            ValueWhenUnsetOption: RECOMMENDED_VALUE
      - DecimalParameterDeclaration:
          DefaultValues:
            StaticValues:
            - 10.0
          Name: EC2DenialOfServiceDnsGoal
          ParameterValueType: SINGLE_VALUED
          ValueWhenUnset:
            ValueWhenUnsetOption: RECOMMENDED_VALUE
      - DecimalParameterDeclaration:
          DefaultValues:
            StaticValues:
            - 10.0
          Name: EC2DenialOfServiceTcpGoal
          ParameterValueType: SINGLE_VALUED
          ValueWhenUnset:
            ValueWhenUnsetOption: RECOMMENDED_VALUE
      - DecimalParameterDeclaration:
          DefaultValues:
            StaticValues:
            - 10.0
          Name: EC2DenialOfServiceUdpGoal
          ParameterValueType: SINGLE_VALUED
          ValueWhenUnset:
            ValueWhenUnsetOption: RECOMMENDED_VALUE
      - DecimalParameterDeclaration:
          DefaultValues:
            StaticValues:
            - 10.0
          Name: EC2DenialOfServiceUdpOnTcpPortsGoal
          ParameterValueType: SINGLE_VALUED
          ValueWhenUnset:
            ValueWhenUnsetOption: RECOMMENDED_VALUE
      - DecimalParameterDeclaration:
          DefaultValues:
            StaticValues:
            - 10.0
          Name: EC2DenialOfServiceUnusualProtocolGoal
          ParameterValueType: SINGLE_VALUED
          ValueWhenUnset:
            ValueWhenUnsetOption: RECOMMENDED_VALUE
      - DecimalParameterDeclaration:
          DefaultValues:
            StaticValues:
            - 10.0
          Name: RDSAnomalousBehaviorSuccessfulBruteForceGoal
          ParameterValueType: SINGLE_VALUED
          ValueWhenUnset:
            ValueWhenUnsetOption: RECOMMENDED_VALUE
      - DecimalParameterDeclaration:
          DefaultValues:
            StaticValues:
            - 10.0
          Name: S3AnomalousBehaviorGoal
          ParameterValueType: SINGLE_VALUED
          ValueWhenUnset:
            ValueWhenUnsetOption: RECOMMENDED_VALUE
      - DecimalParameterDeclaration:
          DefaultValues:
            StaticValues:
            - 10.0
          Name: S3MaliciousIPCallerGoal
          ParameterValueType: SINGLE_VALUED
          ValueWhenUnset:
            ValueWhenUnsetOption: RECOMMENDED_VALUE
      - DecimalParameterDeclaration:
          DefaultValues:
            StaticValues:
            - 10.0
          Name: S3MaliciousIPCallerCustomGoal
          ParameterValueType: SINGLE_VALUED
          ValueWhenUnset:
            ValueWhenUnsetOption: RECOMMENDED_VALUE
      - DecimalParameterDeclaration:
          DefaultValues:
            StaticValues:
            - 10.0
          Name: EC2TrafficVolumeUnusualGoal
          ParameterValueType: SINGLE_VALUED
          ValueWhenUnset:
            ValueWhenUnsetOption: RECOMMENDED_VALUE
      - DecimalParameterDeclaration:
          DefaultValues:
            StaticValues:
            - 10.0
          Name: EC2NetworkPortUnusualGoal
          ParameterValueType: SINGLE_VALUED
          ValueWhenUnset:
            ValueWhenUnsetOption: RECOMMENDED_VALUE
      - IntegerParameterDeclaration:
          DefaultValues:
            StaticValues:
            - 10
          Name: BlockedGoal
          ParameterValueType: SINGLE_VALUED
          ValueWhenUnset:
            ValueWhenUnsetOption: RECOMMENDED_VALUE
      - IntegerParameterDeclaration:
          DefaultValues:
            StaticValues:
            - 10
          Name: PatchingGoal
          ParameterValueType: SINGLE_VALUED
          ValueWhenUnset:
            ValueWhenUnsetOption: RECOMMENDED_VALUE
      - IntegerParameterDeclaration:
          DefaultValues:
            StaticValues:
            - 10
          Name: EC2UnusualDNSResolverGoal
          ParameterValueType: SINGLE_VALUED
          ValueWhenUnset:
            ValueWhenUnsetOption: RECOMMENDED_VALUE
      Sheets:
      - ContentType: INTERACTIVE
        FilterControls:
        - Dropdown:
            DisplayOptions:
              InfoIconLabelOptions:
                Visibility: HIDDEN
              SelectAllOptions:
                Visibility: VISIBLE
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            FilterControlId: dbed6fce-bd64-4ede-8839-ed5ff67d6144
            SourceFilterId: 96374bfa-6314-4767-95d6-1f877edbe080
            Title: Web ACL
            Type: MULTI_SELECT
        Layouts:
        - Configuration:
            GridLayout:
              CanvasSizeOptions:
                ScreenCanvasSizeOptions:
                  OptimizedViewPortWidth: 1600px
                  ResizeOption: FIXED
              Elements:
              - ColumnIndex: 0
                ColumnSpan: 24
                ElementId: 6b7d42cb-44ec-4bd7-86e7-d89c57cbfa5e
                ElementType: TEXT_BOX
                RowIndex: 0
                RowSpan: 3
              - ColumnIndex: 0
                ColumnSpan: 36
                ElementId: f38dc396-f481-44a7-aec0-b39ec344cad6
                ElementType: TEXT_BOX
                RowIndex: 3
                RowSpan: 1
              - ColumnIndex: 0
                ColumnSpan: 9
                ElementId: c874c024-dc89-4d98-8a78-5c4b78806c95
                ElementType: VISUAL
                RowIndex: 4
                RowSpan: 4
              - ColumnIndex: 9
                ColumnSpan: 20
                ElementId: 1794e969-cd8c-4475-b6eb-f44dd529b53b
                ElementType: VISUAL
                RowIndex: 4
                RowSpan: 8
              - ColumnIndex: 0
                ColumnSpan: 9
                ElementId: dbed6fce-bd64-4ede-8839-ed5ff67d6144
                ElementType: FILTER_CONTROL
                RowIndex: 8
                RowSpan: 4
              - ColumnIndex: 0
                ColumnSpan: 36
                ElementId: 18cdc156-a27a-478a-a273-db038ad8d206
                ElementType: TEXT_BOX
                RowIndex: 12
                RowSpan: 1
              - ColumnIndex: 0
                ColumnSpan: 9
                ElementId: c6c74e4e-3624-4193-9d71-51de0ed4bb20
                ElementType: VISUAL
                RowIndex: 13
                RowSpan: 9
              - ColumnIndex: 9
                ColumnSpan: 27
                ElementId: fe98737f-44e5-4863-8a97-e89d8a31f7a8
                ElementType: VISUAL
                RowIndex: 13
                RowSpan: 9
              - ColumnIndex: 0
                ColumnSpan: 36
                ElementId: 10bd2c88-a521-41f7-9cf1-ab4cd3d8e011
                ElementType: TEXT_BOX
                RowIndex: 22
                RowSpan: 1
              - ColumnIndex: 0
                ColumnSpan: 9
                ElementId: d49f8a48-ca5b-447c-bd2c-e4df28c63651
                ElementType: VISUAL
                RowIndex: 23
                RowSpan: 6
              - ColumnIndex: 9
                ColumnSpan: 26
                ElementId: f0962114-ad0b-40cb-9145-56f2462cad34
                ElementType: VISUAL
                RowIndex: 23
                RowSpan: 6
        Name: KPI Tracker
        SheetId: 658ce5c3-48dc-4dc9-b1ec-f94527699c3d
        TextBoxes:
        - Content: |-
            <text-box>
              <inline color="#7fd4b9" font-size="20px">
                <b>Patching Compliance KPIs</b>
              </inline>
            </text-box>
          SheetTextBoxId: 10bd2c88-a521-41f7-9cf1-ab4cd3d8e011
        - Content: "<text-box>\n  <inline font-size=\"22.4px\">\n    <b>KPI Goals Tracking</b>\n\
            \  </inline>\n  <br/>\n  <inline font-size=\"16px\">\n    <b>Customize the KPI\
            \ goals in the Set KPI Goals sheet</b>\n  </inline>\n  <br/>\n  <b>\n    <i>Note:\_\
            </i>\n  </b>\n  <inline color=\"#33ea17\">\n    <i>Green\_</i>\n  </inline>\n\
            \  <i>background highlights where you are meeting or exceeding a KPI goal,\_\
            </i>\n  <inline color=\"#ee1010\">\n    <i>red\_</i>\n  </inline>\n  <i>background\
            \ highlights where you are not meeting the KPI goal</i>\n</text-box>"
          SheetTextBoxId: 6b7d42cb-44ec-4bd7-86e7-d89c57cbfa5e
        - Content: |-
            <text-box>
              <inline color="#7fd4b9" font-size="20px">
                <b>Amazon GuardDuty KPIs</b>
              </inline>
            </text-box>
          SheetTextBoxId: 18cdc156-a27a-478a-a273-db038ad8d206
        - Content: "<text-box>\n  <inline color=\"#7fd4b9\" font-size=\"20px\">\n    <b>AWS\
            \ WAF KPIs\_\_</b>\n  </inline>\n</text-box>"
          SheetTextBoxId: f38dc396-f481-44a7-aec0-b39ec344cad6
        Title: Security KPI Tracker
        Visuals:
        - PivotTableVisual:
            Actions: []
            ChartConfiguration:
              FieldOptions:
                DataPathOptions:
                - DataPathList:
                  - FieldId: f31988d8-85c3-4215-9698-969eb5f2e1ca.webaclid.2.1686648770574
                    FieldValue: webaclid
                  Width: 329px
                SelectedFieldOptions:
                - CustomLabel: Web ACL
                  FieldId: f31988d8-85c3-4215-9698-969eb5f2e1ca.webaclid.2.1686648770574
                  Visibility: VISIBLE
                - CustomLabel: Months
                  FieldId: f31988d8-85c3-4215-9698-969eb5f2e1ca.timestamp.0.1686068655727
                  Visibility: VISIBLE
                - CustomLabel: Blocked
                  FieldId: 7edbb896-756d-4f46-8860-ec47bad67b0f.3.1686072707327
                  Visibility: VISIBLE
              FieldWells:
                PivotTableAggregatedFieldWells:
                  Columns:
                  - DateDimensionField:
                      Column:
                        ColumnName: timestamp
                        DataSetIdentifier: kpi_waf
                      DateGranularity: MONTH
                      FieldId: f31988d8-85c3-4215-9698-969eb5f2e1ca.timestamp.0.1686068655727
                  Rows:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: webaclid
                        DataSetIdentifier: kpi_waf
                      FieldId: f31988d8-85c3-4215-9698-969eb5f2e1ca.webaclid.2.1686648770574
                  Values:
                  - NumericalMeasureField:
                      Column:
                        ColumnName: BlockedPercentage
                        DataSetIdentifier: kpi_waf
                      FieldId: 7edbb896-756d-4f46-8860-ec47bad67b0f.3.1686072707327
              SortConfiguration:
                FieldSortOptions: []
              TableOptions:
                CellStyle:
                  Height: 25
                  TextWrap: WRAP
                CollapsedRowDimensionsVisibility: HIDDEN
                ColumnHeaderStyle:
                  TextWrap: WRAP
                MetricPlacement: COLUMN
            ConditionalFormatting:
              ConditionalFormattingOptions:
              - Cell:
                  FieldId: 7edbb896-756d-4f46-8860-ec47bad67b0f.3.1686072707327
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#30CB71'
                        Expression: '{BlockedTrend} >= 1'
              - Cell:
                  FieldId: 7edbb896-756d-4f46-8860-ec47bad67b0f.3.1686072707327
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#EE1010'
                        Expression: '{BlockedTrend} < 1'
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: |-
                  <visual-title>
                    <inline font-size="16px">Results</inline>
                  </visual-title>
              Visibility: VISIBLE
            VisualId: 1794e969-cd8c-4475-b6eb-f44dd529b53b
        - PivotTableVisual:
            Actions: []
            ChartConfiguration:
              FieldOptions:
                DataPathOptions:
                - DataPathList:
                  - FieldId: 51650d63-17cb-486e-99e2-29878238c96c.1.1686071580718
                    FieldValue: e566791f-ec35-4529-aa0e-c852c1277cce
                  Width: 124px
                SelectedFieldOptions:
                - FieldId: 51650d63-17cb-486e-99e2-29878238c96c.1.1686071580718
                  Visibility: VISIBLE
                - CustomLabel: Blocked
                  FieldId: e566791f-ec35-4529-aa0e-c852c1277cce.0.1686071379589
                  Visibility: VISIBLE
              FieldWells:
                PivotTableAggregatedFieldWells:
                  Columns:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: Goals
                        DataSetIdentifier: kpi_waf
                      FieldId: 51650d63-17cb-486e-99e2-29878238c96c.1.1686071580718
                  Rows: []
                  Values:
                  - NumericalMeasureField:
                      Column:
                        ColumnName: BlockedGoal
                        DataSetIdentifier: kpi_waf
                      FieldId: e566791f-ec35-4529-aa0e-c852c1277cce.0.1686071379589
              SortConfiguration:
                FieldSortOptions: []
              TableOptions:
                CellStyle:
                  Height: 25
                  TextWrap: NONE
                CollapsedRowDimensionsVisibility: HIDDEN
                ColumnHeaderStyle:
                  TextWrap: WRAP
                ColumnNamesVisibility: HIDDEN
                MetricPlacement: ROW
            ConditionalFormatting:
              ConditionalFormattingOptions:
              - Cell:
                  FieldId: e566791f-ec35-4529-aa0e-c852c1277cce.0.1686071379589
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    Icon:
                      CustomCondition:
                        Expression: '{BlockedGoal} >= 0'
                        IconOptions:
                          UnicodeIcon: "\u2264"
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: |-
                  <visual-title>
                    <inline font-size="16px">Goals Configured</inline>
                  </visual-title>
              Visibility: VISIBLE
            VisualId: c874c024-dc89-4d98-8a78-5c4b78806c95
        - PivotTableVisual:
            Actions: []
            ChartConfiguration:
              FieldOptions:
                DataPathOptions:
                - DataPathList:
                  - FieldId: cd6b1e69-2afc-4f72-bc24-7e913d4da97b.createdat.1.1686333396010
                    FieldValue: ___metric_row_data_key_6ad7318e-c59f-11e7-abc4-cec278b6b50a___
                  Width: 281px
                SelectedFieldOptions:
                - CustomLabel: Months
                  FieldId: cd6b1e69-2afc-4f72-bc24-7e913d4da97b.createdat.1.1686333396010
                  Visibility: VISIBLE
                - CustomLabel: EC2 Denial Of Service DNS
                  FieldId: be681cb0-6699-44ce-88d1-bd8ea3e1b208.2.1698092958574
                  Visibility: VISIBLE
                - CustomLabel: EC2 Denial Of Service TCP
                  FieldId: a463b7aa-ac80-4b5b-8639-fe2ee75bab09.3.1698092970675
                  Visibility: VISIBLE
                - CustomLabel: EC2 Denial Of Service UDP
                  FieldId: a72b4e01-9485-43dc-9607-a607e43fbfad.4.1698092972395
                  Visibility: VISIBLE
                - CustomLabel: EC2 Denial Of Service UDP on TCP ports
                  FieldId: 0133d352-8cf9-424e-84de-872dab860cb1.5.1698092980572
                  Visibility: VISIBLE
                - CustomLabel: EC2 Denial Of Service Unusual Protocol
                  FieldId: 0c3f0a67-cdaf-4a44-adb7-2a0302a7eed6.6.1698092991842
                  Visibility: VISIBLE
                - CustomLabel: EC2 Traffic Volume Unusual
                  FieldId: 9a9c8f65-9a6c-4d02-82bc-84790e494a85.7.1698093005517
                  Visibility: VISIBLE
                - CustomLabel: RDS Anomalous Behavior Successful Brute Force
                  FieldId: 20bc1b4c-f438-4b64-927a-515e524a37e2.8.1698093011188
                  Visibility: VISIBLE
                - CustomLabel: S3 Anomalous Behavior
                  FieldId: e3d0af1c-3f65-46fa-9df4-31c80b5754d3.11.1698093042140
                  Visibility: VISIBLE
                - CustomLabel: S3 Malicious IPCaller
                  FieldId: 761d6f5d-4732-4663-a889-3680ace90b39.10.1698093038412
                  Visibility: VISIBLE
                - CustomLabel: S3 Malicious IPCaller Custom
                  FieldId: c9357fda-6e6b-4164-a1c5-432ff592c257.9.1698093035645
                  Visibility: VISIBLE
                - CustomLabel: Root Credential Usage
                  FieldId: 240e15d6-25b9-4b96-9d1b-01ddd6371f5a.0.1686333378684
                  Visibility: VISIBLE
              FieldWells:
                PivotTableAggregatedFieldWells:
                  Columns:
                  - DateDimensionField:
                      Column:
                        ColumnName: createdat
                        DataSetIdentifier: kpi_guardduty
                      DateGranularity: MONTH
                      FieldId: cd6b1e69-2afc-4f72-bc24-7e913d4da97b.createdat.1.1686333396010
                  Rows: []
                  Values:
                  - NumericalMeasureField:
                      AggregationFunction:
                        SimpleNumericalAggregation: SUM
                      Column:
                        ColumnName: _EC2DenialOfServiceDns
                        DataSetIdentifier: kpi_guardduty
                      FieldId: be681cb0-6699-44ce-88d1-bd8ea3e1b208.2.1698092958574
                  - NumericalMeasureField:
                      AggregationFunction:
                        SimpleNumericalAggregation: SUM
                      Column:
                        ColumnName: _EC2DenialOfServiceTcp
                        DataSetIdentifier: kpi_guardduty
                      FieldId: a463b7aa-ac80-4b5b-8639-fe2ee75bab09.3.1698092970675
                  - NumericalMeasureField:
                      AggregationFunction:
                        SimpleNumericalAggregation: SUM
                      Column:
                        ColumnName: _EC2DenialOfServiceUdp
                        DataSetIdentifier: kpi_guardduty
                      FieldId: a72b4e01-9485-43dc-9607-a607e43fbfad.4.1698092972395
                  - NumericalMeasureField:
                      AggregationFunction:
                        SimpleNumericalAggregation: SUM
                      Column:
                        ColumnName: _EC2DenialOfServiceUdpOnTcpPorts
                        DataSetIdentifier: kpi_guardduty
                      FieldId: 0133d352-8cf9-424e-84de-872dab860cb1.5.1698092980572
                  - NumericalMeasureField:
                      AggregationFunction:
                        SimpleNumericalAggregation: SUM
                      Column:
                        ColumnName: _EC2DenialOfServiceUnusualProtocol
                        DataSetIdentifier: kpi_guardduty
                      FieldId: 0c3f0a67-cdaf-4a44-adb7-2a0302a7eed6.6.1698092991842
                  - NumericalMeasureField:
                      AggregationFunction:
                        SimpleNumericalAggregation: SUM
                      Column:
                        ColumnName: _EC2TrafficVolumeUnusual
                        DataSetIdentifier: kpi_guardduty
                      FieldId: 9a9c8f65-9a6c-4d02-82bc-84790e494a85.7.1698093005517
                  - NumericalMeasureField:
                      AggregationFunction:
                        SimpleNumericalAggregation: SUM
                      Column:
                        ColumnName: _RDSAnomalousBehaviorSuccessfulBruteForce
                        DataSetIdentifier: kpi_guardduty
                      FieldId: 20bc1b4c-f438-4b64-927a-515e524a37e2.8.1698093011188
                  - NumericalMeasureField:
                      AggregationFunction:
                        SimpleNumericalAggregation: SUM
                      Column:
                        ColumnName: _S3AnomalousBehavior
                        DataSetIdentifier: kpi_guardduty
                      FieldId: e3d0af1c-3f65-46fa-9df4-31c80b5754d3.11.1698093042140
                  - NumericalMeasureField:
                      AggregationFunction:
                        SimpleNumericalAggregation: SUM
                      Column:
                        ColumnName: _S3MaliciousIPCaller
                        DataSetIdentifier: kpi_guardduty
                      FieldId: 761d6f5d-4732-4663-a889-3680ace90b39.10.1698093038412
                  - NumericalMeasureField:
                      AggregationFunction:
                        SimpleNumericalAggregation: SUM
                      Column:
                        ColumnName: _S3MaliciousIPCallerCustom
                        DataSetIdentifier: kpi_guardduty
                      FieldId: c9357fda-6e6b-4164-a1c5-432ff592c257.9.1698093035645
                  - NumericalMeasureField:
                      AggregationFunction:
                        SimpleNumericalAggregation: SUM
                      Column:
                        ColumnName: _rootCredentialUsage
                        DataSetIdentifier: kpi_guardduty
                      FieldId: 240e15d6-25b9-4b96-9d1b-01ddd6371f5a.0.1686333378684
              SortConfiguration:
                FieldSortOptions: []
              TableOptions:
                CellStyle:
                  Height: 25
                  TextWrap: WRAP
                CollapsedRowDimensionsVisibility: HIDDEN
                ColumnHeaderStyle:
                  TextWrap: WRAP
                MetricPlacement: ROW
                RowHeaderStyle:
                  HorizontalTextAlignment: LEFT
            ConditionalFormatting:
              ConditionalFormattingOptions:
              - Cell:
                  FieldId: e3d0af1c-3f65-46fa-9df4-31c80b5754d3.11.1698093042140
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#EE1010'
                        Expression: '{_S3AnomalousBehaviorTrend} > 0'
              - Cell:
                  FieldId: e3d0af1c-3f65-46fa-9df4-31c80b5754d3.11.1698093042140
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#30CB71'
                        Expression: '{_S3AnomalousBehaviorTrend} <= 0'
              - Cell:
                  FieldId: 0133d352-8cf9-424e-84de-872dab860cb1.5.1698092980572
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#EE1010'
                        Expression: '{_EC2DenialOfServiceUdpOnTcpPortsTrend} > 0'
              - Cell:
                  FieldId: 0133d352-8cf9-424e-84de-872dab860cb1.5.1698092980572
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#30CB71'
                        Expression: '{_EC2DenialOfServiceUdpOnTcpPortsTrend} <= 0'
              - Cell:
                  FieldId: 9a9c8f65-9a6c-4d02-82bc-84790e494a85.7.1698093005517
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#EE1010'
                        Expression: '{_EC2TrafficVolumeUnusualTrend} > 0'
              - Cell:
                  FieldId: 9a9c8f65-9a6c-4d02-82bc-84790e494a85.7.1698093005517
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#30CB71'
                        Expression: '{_EC2TrafficVolumeUnusualTrend} <= 0'
              - Cell:
                  FieldId: 240e15d6-25b9-4b96-9d1b-01ddd6371f5a.0.1686333378684
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#EE1010'
                        Expression: '{_rootCredentialUsageTrend} > 0'
              - Cell:
                  FieldId: 240e15d6-25b9-4b96-9d1b-01ddd6371f5a.0.1686333378684
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#30CB71'
                        Expression: '{_rootCredentialUsageTrend} <= 0'
              - Cell:
                  FieldId: c9357fda-6e6b-4164-a1c5-432ff592c257.9.1698093035645
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#EE1010'
                        Expression: '{_S3MaliciousIPCallerCustomTrend} > 0'
              - Cell:
                  FieldId: c9357fda-6e6b-4164-a1c5-432ff592c257.9.1698093035645
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#30CB71'
                        Expression: '{_S3MaliciousIPCallerCustomTrend} <= 0'
              - Cell:
                  FieldId: a72b4e01-9485-43dc-9607-a607e43fbfad.4.1698092972395
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#EE1010'
                        Expression: '{_EC2DenialOfServiceUdpTrend} > 0'
              - Cell:
                  FieldId: a72b4e01-9485-43dc-9607-a607e43fbfad.4.1698092972395
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#30CB71'
                        Expression: '{_EC2DenialOfServiceUdpTrend} <= 0'
              - Cell:
                  FieldId: be681cb0-6699-44ce-88d1-bd8ea3e1b208.2.1698092958574
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#EE1010'
                        Expression: '{_EC2DenialOfServiceDnsTrend} > 0'
              - Cell:
                  FieldId: be681cb0-6699-44ce-88d1-bd8ea3e1b208.2.1698092958574
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#30CB71'
                        Expression: '{_EC2DenialOfServiceDnsTrend} <= 0'
              - Cell:
                  FieldId: 0c3f0a67-cdaf-4a44-adb7-2a0302a7eed6.6.1698092991842
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#EE1010'
                        Expression: '{_EC2DenialOfServiceUnusualProtocolTrend} > 0'
              - Cell:
                  FieldId: 0c3f0a67-cdaf-4a44-adb7-2a0302a7eed6.6.1698092991842
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#30CB71'
                        Expression: '{_EC2DenialOfServiceUnusualProtocolTrend} <= 0'
              - Cell:
                  FieldId: 20bc1b4c-f438-4b64-927a-515e524a37e2.8.1698093011188
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#EE1010'
                        Expression: '{_RDSAnomalousBehaviorSuccessfulBruteForceTrend} >
                          0'
              - Cell:
                  FieldId: 20bc1b4c-f438-4b64-927a-515e524a37e2.8.1698093011188
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#30CB71'
                        Expression: '{_RDSAnomalousBehaviorSuccessfulBruteForceTrend} <=
                          0'
              - Cell:
                  FieldId: a463b7aa-ac80-4b5b-8639-fe2ee75bab09.3.1698092970675
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#EE1010'
                        Expression: '{_EC2DenialOfServiceTcpTrend} > 0'
              - Cell:
                  FieldId: a463b7aa-ac80-4b5b-8639-fe2ee75bab09.3.1698092970675
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#30CB71'
                        Expression: '{_EC2DenialOfServiceTcpTrend} <= 0'
              - Cell:
                  FieldId: 761d6f5d-4732-4663-a889-3680ace90b39.10.1698093038412
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#EE1010'
                        Expression: '{_S3MaliciousIPCallerTrend} > 0'
              - Cell:
                  FieldId: 761d6f5d-4732-4663-a889-3680ace90b39.10.1698093038412
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#30CB71'
                        Expression: '{_S3MaliciousIPCallerTrend} <= 0'
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: |-
                  <visual-title>
                    <inline font-size="16px">Results</inline>
                  </visual-title>
              Visibility: VISIBLE
            VisualId: fe98737f-44e5-4863-8a97-e89d8a31f7a8
        - PivotTableVisual:
            Actions: []
            ChartConfiguration:
              FieldOptions:
                DataPathOptions:
                - DataPathList:
                  - FieldId: ebb04fec-8240-4a9b-9101-25f1a139b3ad.1.1686565043117
                    FieldValue: ___metric_row_data_key_6ad7318e-c59f-11e7-abc4-cec278b6b50a___
                  Width: 281px
                SelectedFieldOptions:
                - FieldId: ebb04fec-8240-4a9b-9101-25f1a139b3ad.1.1686565043117
                  Visibility: VISIBLE
                - CustomLabel: EC2 Denial Of Service DNS
                  FieldId: f63eea44-09d5-4f88-8803-6379d75d6c18.2.1698092253520
                  Visibility: VISIBLE
                - CustomLabel: EC2 Denial Of Service TCP
                  FieldId: db4f6222-3959-40c0-86f5-42f9b15c2f60.3.1698092256979
                  Visibility: VISIBLE
                - CustomLabel: EC2 Denial Of Service UDP
                  FieldId: 3fdf6b37-dd2f-41bf-ba72-957097ab4f3e.4.1698092260635
                  Visibility: VISIBLE
                - CustomLabel: EC2 Denial Of Service UDP on TCP ports
                  FieldId: cbe0fc22-4b86-475c-803f-8a77daf8c781.6.1698092298615
                  Visibility: VISIBLE
                - CustomLabel: EC2 Denial Of Service Unusual Protocol
                  FieldId: 13b4f97c-768a-4bd4-bbcc-b7547406f596.6.1698092267635
                  Visibility: VISIBLE
                - CustomLabel: EC2 Traffic Volume Unusual
                  FieldId: 4a4a139f-d741-418a-93a1-5bddca8a22d5.7.1698092271586
                  Visibility: VISIBLE
                - CustomLabel: RDS Anomalous Behavior Successful Brute Force
                  FieldId: 5cee9301-fb1c-4604-91ec-08548dcd6aff.7.1698092303859
                  Visibility: VISIBLE
                - CustomLabel: S3 Anomalous Behavior
                  FieldId: 7098e719-c40c-451a-adce-3e4361d1e414.8.1698092308555
                  Visibility: VISIBLE
                - CustomLabel: S3 Malicious IPCaller
                  FieldId: 6c279129-606c-4874-92f4-9b8471ba09f3.9.1698092315789
                  Visibility: VISIBLE
                - CustomLabel: S3 Malicious IPCaller Custom
                  FieldId: 57da39a7-42a0-4a88-868c-f4f77619e2e8.10.1698092318677
                  Visibility: VISIBLE
                - CustomLabel: Root Credential Usage
                  FieldId: c331617c-b4ef-4183-b785-21eece5f0425.11.1698093424418
                  Visibility: VISIBLE
              FieldWells:
                PivotTableAggregatedFieldWells:
                  Columns:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: Goals
                        DataSetIdentifier: kpi_guardduty
                      FieldId: ebb04fec-8240-4a9b-9101-25f1a139b3ad.1.1686565043117
                  Rows: []
                  Values:
                  - NumericalMeasureField:
                      Column:
                        ColumnName: _EC2DenialOfServiceDnsGoal
                        DataSetIdentifier: kpi_guardduty
                      FieldId: f63eea44-09d5-4f88-8803-6379d75d6c18.2.1698092253520
                  - NumericalMeasureField:
                      Column:
                        ColumnName: _EC2DenialOfServiceTcpGoal
                        DataSetIdentifier: kpi_guardduty
                      FieldId: db4f6222-3959-40c0-86f5-42f9b15c2f60.3.1698092256979
                  - NumericalMeasureField:
                      Column:
                        ColumnName: _EC2DenialOfServiceUdpGoal
                        DataSetIdentifier: kpi_guardduty
                      FieldId: 3fdf6b37-dd2f-41bf-ba72-957097ab4f3e.4.1698092260635
                  - NumericalMeasureField:
                      Column:
                        ColumnName: _EC2DenialOfServiceUdpOnTcpPortsGoal
                        DataSetIdentifier: kpi_guardduty
                      FieldId: cbe0fc22-4b86-475c-803f-8a77daf8c781.6.1698092298615
                  - NumericalMeasureField:
                      Column:
                        ColumnName: _EC2DenialOfServiceUnusualProtocolGoal
                        DataSetIdentifier: kpi_guardduty
                      FieldId: 13b4f97c-768a-4bd4-bbcc-b7547406f596.6.1698092267635
                  - NumericalMeasureField:
                      Column:
                        ColumnName: _EC2TrafficVolumeUnusualGoal
                        DataSetIdentifier: kpi_guardduty
                      FieldId: 4a4a139f-d741-418a-93a1-5bddca8a22d5.7.1698092271586
                  - NumericalMeasureField:
                      Column:
                        ColumnName: _RDSAnomalousBehaviorSuccessfulBruteForceGoal
                        DataSetIdentifier: kpi_guardduty
                      FieldId: 5cee9301-fb1c-4604-91ec-08548dcd6aff.7.1698092303859
                  - NumericalMeasureField:
                      Column:
                        ColumnName: _S3AnomalousBehaviorGoal
                        DataSetIdentifier: kpi_guardduty
                      FieldId: 7098e719-c40c-451a-adce-3e4361d1e414.8.1698092308555
                  - NumericalMeasureField:
                      Column:
                        ColumnName: _S3MaliciousIPCallerGoal
                        DataSetIdentifier: kpi_guardduty
                      FieldId: 6c279129-606c-4874-92f4-9b8471ba09f3.9.1698092315789
                  - NumericalMeasureField:
                      Column:
                        ColumnName: _S3MaliciousIPCallerCustomGoal
                        DataSetIdentifier: kpi_guardduty
                      FieldId: 57da39a7-42a0-4a88-868c-f4f77619e2e8.10.1698092318677
                  - NumericalMeasureField:
                      Column:
                        ColumnName: _rootCredentialUsageGoal
                        DataSetIdentifier: kpi_guardduty
                      FieldId: c331617c-b4ef-4183-b785-21eece5f0425.11.1698093424418
              SortConfiguration:
                FieldSortOptions: []
              TableOptions:
                CellStyle:
                  Height: 26
                  TextWrap: WRAP
                CollapsedRowDimensionsVisibility: HIDDEN
                ColumnHeaderStyle:
                  TextWrap: WRAP
                ColumnNamesVisibility: HIDDEN
                MetricPlacement: ROW
            ConditionalFormatting:
              ConditionalFormattingOptions:
              - Cell:
                  FieldId: c331617c-b4ef-4183-b785-21eece5f0425.11.1698093424418
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    Icon:
                      CustomCondition:
                        Expression: '{_rootCredentialUsageGoal} >= "MID_50_PERCENT"'
                        IconOptions:
                          UnicodeIcon: "\u2264"
              - Cell:
                  FieldId: 5cee9301-fb1c-4604-91ec-08548dcd6aff.7.1698092303859
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    Icon:
                      CustomCondition:
                        Expression: '{_RDSAnomalousBehaviorSuccessfulBruteForceGoal} >=
                          "MID_50_PERCENT"'
                        IconOptions:
                          UnicodeIcon: "\u2264"
              - Cell:
                  FieldId: 57da39a7-42a0-4a88-868c-f4f77619e2e8.10.1698092318677
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    Icon:
                      CustomCondition:
                        Expression: '{_S3MaliciousIPCallerCustomGoal} >= "MID_50_PERCENT"'
                        IconOptions:
                          UnicodeIcon: "\u2264"
              - Cell:
                  FieldId: db4f6222-3959-40c0-86f5-42f9b15c2f60.3.1698092256979
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    Icon:
                      CustomCondition:
                        Expression: '{_EC2DenialOfServiceTcpGoal} >= "MID_50_PERCENT"'
                        IconOptions:
                          UnicodeIcon: "\u2264"
              - Cell:
                  FieldId: 7098e719-c40c-451a-adce-3e4361d1e414.8.1698092308555
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    Icon:
                      CustomCondition:
                        Expression: '{_S3AnomalousBehaviorGoal} >= "MID_50_PERCENT"'
                        IconOptions:
                          UnicodeIcon: "\u2264"
              - Cell:
                  FieldId: cbe0fc22-4b86-475c-803f-8a77daf8c781.6.1698092298615
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    Icon:
                      CustomCondition:
                        Expression: '{_EC2DenialOfServiceUdpOnTcpPortsGoal} >= "MID_50_PERCENT"'
                        IconOptions:
                          UnicodeIcon: "\u2264"
              - Cell:
                  FieldId: 6c279129-606c-4874-92f4-9b8471ba09f3.9.1698092315789
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    Icon:
                      CustomCondition:
                        Expression: '{_S3MaliciousIPCallerGoal} >= "MID_50_PERCENT"'
                        IconOptions:
                          UnicodeIcon: "\u2264"
              - Cell:
                  FieldId: 4a4a139f-d741-418a-93a1-5bddca8a22d5.7.1698092271586
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    Icon:
                      CustomCondition:
                        Expression: '{_EC2TrafficVolumeUnusualGoal} >= "MID_50_PERCENT"'
                        IconOptions:
                          UnicodeIcon: "\u2264"
              - Cell:
                  FieldId: 3fdf6b37-dd2f-41bf-ba72-957097ab4f3e.4.1698092260635
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    Icon:
                      CustomCondition:
                        Expression: '{_EC2DenialOfServiceUdpGoal} >= "MID_50_PERCENT"'
                        IconOptions:
                          UnicodeIcon: "\u2264"
              - Cell:
                  FieldId: 13b4f97c-768a-4bd4-bbcc-b7547406f596.6.1698092267635
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    Icon:
                      CustomCondition:
                        Expression: '{_EC2DenialOfServiceUnusualProtocolGoal} >= "MID_50_PERCENT"'
                        IconOptions:
                          UnicodeIcon: "\u2264"
              - Cell:
                  FieldId: f63eea44-09d5-4f88-8803-6379d75d6c18.2.1698092253520
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    Icon:
                      CustomCondition:
                        Expression: '{_EC2DenialOfServiceDnsGoal} >= "MID_50_PERCENT"'
                        IconOptions:
                          UnicodeIcon: "\u2264"
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: |-
                  <visual-title>
                    <inline font-size="16px">Goals Configured</inline>
                  </visual-title>
              Visibility: VISIBLE
            VisualId: c6c74e4e-3624-4193-9d71-51de0ed4bb20
        - PivotTableVisual:
            Actions: []
            ChartConfiguration:
              FieldOptions:
                DataPathOptions:
                - DataPathList:
                  - FieldId: de5d5d80-ecd2-42bd-b554-319804754a38.0.1686649817061
                    FieldValue: cf160b83-cfe2-4b71-b5cb-86a6d1033f76
                  Width: 157px
                SelectedFieldOptions:
                - FieldId: de5d5d80-ecd2-42bd-b554-319804754a38.0.1686649817061
                  Visibility: VISIBLE
                - CustomLabel: Patching Compliance
                  FieldId: 93e9c11d-303b-4a4c-8359-6f72bb9bc6e4.1.1686649860162
                  Visibility: VISIBLE
              FieldWells:
                PivotTableAggregatedFieldWells:
                  Columns:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: Goals
                        DataSetIdentifier: kpi_patching
                      FieldId: de5d5d80-ecd2-42bd-b554-319804754a38.0.1686649817061
                  Rows: []
                  Values:
                  - NumericalMeasureField:
                      Column:
                        ColumnName: _patchingGoal
                        DataSetIdentifier: kpi_patching
                      FieldId: 93e9c11d-303b-4a4c-8359-6f72bb9bc6e4.1.1686649860162
                      FormatConfiguration:
                        FormatConfiguration:
                          PercentageDisplayFormatConfiguration:
                            NegativeValueConfiguration:
                              DisplayMode: NEGATIVE
                            SeparatorConfiguration:
                              DecimalSeparator: DOT
                              ThousandsSeparator:
                                Symbol: COMMA
                                Visibility: VISIBLE
                            Suffix: '%'
              SortConfiguration:
                FieldSortOptions: []
              TableOptions:
                CellStyle:
                  TextWrap: WRAP
                CollapsedRowDimensionsVisibility: HIDDEN
                ColumnHeaderStyle:
                  TextWrap: WRAP
                ColumnNamesVisibility: HIDDEN
                MetricPlacement: ROW
            ConditionalFormatting:
              ConditionalFormattingOptions:
              - Cell:
                  FieldId: 93e9c11d-303b-4a4c-8359-6f72bb9bc6e4.1.1686649860162
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    Icon:
                      CustomCondition:
                        Expression: '{_patchingGoal} >= "MID_50_PERCENT"'
                        IconOptions:
                          UnicodeIcon: "\u2265"
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: |-
                  <visual-title>
                    <inline font-size="16px">Goals Configured</inline>
                  </visual-title>
              Visibility: VISIBLE
            VisualId: d49f8a48-ca5b-447c-bd2c-e4df28c63651
        - PivotTableVisual:
            Actions: []
            ChartConfiguration:
              FieldOptions:
                SelectedFieldOptions:
                - CustomLabel: Patch Group
                  FieldId: d299c153-0a02-4d5c-b7e2-17571c2459fe.patch_group.2.1686904744261
                  Visibility: VISIBLE
                - CustomLabel: Report Dates
                  FieldId: d299c153-0a02-4d5c-b7e2-17571c2459fe.report_date.0.1686650289384
                  Visibility: VISIBLE
                - CustomLabel: Compliance
                  FieldId: 2ee69d6d-a05a-4d43-8038-6a0fe6d4a97c.2.1686651480983
                  Visibility: VISIBLE
              FieldWells:
                PivotTableAggregatedFieldWells:
                  Columns:
                  - DateDimensionField:
                      Column:
                        ColumnName: report_date
                        DataSetIdentifier: kpi_patching
                      DateGranularity: DAY
                      FieldId: d299c153-0a02-4d5c-b7e2-17571c2459fe.report_date.0.1686650289384
                  Rows:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: patch_group
                        DataSetIdentifier: kpi_patching
                      FieldId: d299c153-0a02-4d5c-b7e2-17571c2459fe.patch_group.2.1686904744261
                  Values:
                  - NumericalMeasureField:
                      Column:
                        ColumnName: _patchingCompliancePercentage
                        DataSetIdentifier: kpi_patching
                      FieldId: 2ee69d6d-a05a-4d43-8038-6a0fe6d4a97c.2.1686651480983
                      FormatConfiguration:
                        FormatConfiguration:
                          PercentageDisplayFormatConfiguration:
                            NegativeValueConfiguration:
                              DisplayMode: NEGATIVE
                            SeparatorConfiguration:
                              DecimalSeparator: DOT
                              ThousandsSeparator:
                                Symbol: COMMA
                                Visibility: VISIBLE
                            Suffix: '%'
              SortConfiguration:
                FieldSortOptions: []
              TableOptions:
                CellStyle:
                  Height: 25
                  TextWrap: WRAP
                CollapsedRowDimensionsVisibility: HIDDEN
                ColumnHeaderStyle:
                  TextWrap: WRAP
                MetricPlacement: COLUMN
            ConditionalFormatting:
              ConditionalFormattingOptions:
              - Cell:
                  FieldId: 2ee69d6d-a05a-4d43-8038-6a0fe6d4a97c.2.1686651480983
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#EE1010'
                        Expression: '{_patchingComplianceTrend} > 1'
              - Cell:
                  FieldId: 2ee69d6d-a05a-4d43-8038-6a0fe6d4a97c.2.1686651480983
                  Scopes:
                  - Role: FIELD
                  TextFormat:
                    BackgroundColor:
                      Solid:
                        Color: '#30CB71'
                        Expression: '{_patchingComplianceTrend} <= 1'
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: <visual-title>Results</visual-title>
              Visibility: VISIBLE
            VisualId: f0962114-ad0b-40cb-9145-56f2462cad34
      - ContentType: INTERACTIVE
        Layouts:
        - Configuration:
            GridLayout:
              CanvasSizeOptions:
                ScreenCanvasSizeOptions:
                  OptimizedViewPortWidth: 1600px
                  ResizeOption: FIXED
              Elements:
              - ColumnIndex: 0
                ColumnSpan: 36
                ElementId: 5fa2ac59-5ebf-4fc1-a7c6-71cdbd7f5b8a
                ElementType: TEXT_BOX
                RowIndex: 0
                RowSpan: 3
              - ColumnIndex: 0
                ColumnSpan: 36
                ElementId: 8d47a9de-982d-43d4-bd4c-233fd231dd90
                ElementType: TEXT_BOX
                RowIndex: 3
                RowSpan: 1
              - ColumnIndex: 0
                ColumnSpan: 6
                ElementId: 5e4d2fb9-db69-4814-a5d4-2c85c1bac7ed
                ElementType: PARAMETER_CONTROL
                RowIndex: 4
                RowSpan: 3
              - ColumnIndex: 0
                ColumnSpan: 36
                ElementId: 176916bc-15de-4cc4-b55f-34189f920ef5
                ElementType: TEXT_BOX
                RowIndex: 7
                RowSpan: 1
              - ColumnIndex: 0
                ColumnSpan: 6
                ElementId: 25110f1c-a6a1-41da-b679-f8832a6e6e21
                ElementType: PARAMETER_CONTROL
                RowIndex: 8
                RowSpan: 3
              - ColumnIndex: 6
                ColumnSpan: 6
                ElementId: 91022510-2de0-4e18-a5c5-37d79a363cfe
                ElementType: PARAMETER_CONTROL
                RowIndex: 8
                RowSpan: 3
              - ColumnIndex: 12
                ColumnSpan: 6
                ElementId: f9352b9a-ba5b-4722-889c-d4aa01602673
                ElementType: PARAMETER_CONTROL
                RowIndex: 8
                RowSpan: 3
              - ColumnIndex: 18
                ColumnSpan: 6
                ElementId: e56ad13f-ddda-4587-b953-ca14230f66af
                ElementType: PARAMETER_CONTROL
                RowIndex: 8
                RowSpan: 3
              - ColumnIndex: 24
                ColumnSpan: 6
                ElementId: 0e31a82b-451c-4583-8c28-a4d310c32995
                ElementType: PARAMETER_CONTROL
                RowIndex: 8
                RowSpan: 3
              - ColumnIndex: 0
                ColumnSpan: 6
                ElementId: 0add87ed-1bc7-4806-b187-cbe978a5f217
                ElementType: PARAMETER_CONTROL
                RowIndex: 11
                RowSpan: 3
              - ColumnIndex: 6
                ColumnSpan: 6
                ElementId: a74840bd-b82d-4062-bbe7-47effa3ad8b8
                ElementType: PARAMETER_CONTROL
                RowIndex: 11
                RowSpan: 3
              - ColumnIndex: 12
                ColumnSpan: 6
                ElementId: 63f3d747-69b2-4082-931d-c2e097808fa7
                ElementType: PARAMETER_CONTROL
                RowIndex: 11
                RowSpan: 3
              - ColumnIndex: 18
                ColumnSpan: 6
                ElementId: 62684e6c-285b-480c-8b1e-8c8c7bd265fe
                ElementType: PARAMETER_CONTROL
                RowIndex: 11
                RowSpan: 3
              - ColumnIndex: 24
                ColumnSpan: 6
                ElementId: 92bfab40-10cc-453d-99b0-e6ec4475cdf7
                ElementType: PARAMETER_CONTROL
                RowIndex: 11
                RowSpan: 3
              - ColumnIndex: 0
                ColumnSpan: 6
                ElementId: f2998949-712c-4b91-b6b6-98eb1c3a0e73
                ElementType: PARAMETER_CONTROL
                RowIndex: 14
                RowSpan: 3
              - ColumnIndex: 0
                ColumnSpan: 36
                ElementId: f2ec651b-32c9-4654-885e-d2015cd867ce
                ElementType: TEXT_BOX
                RowIndex: 17
                RowSpan: 1
              - ColumnIndex: 0
                ColumnSpan: 6
                ElementId: bd64c334-3bce-47e5-8d68-9dee130a5738
                ElementType: PARAMETER_CONTROL
                RowIndex: 18
                RowSpan: 3
        Name: 'Set KPI Goals '
        ParameterControls:
        - Slider:
            DisplayOptions:
              InfoIconLabelOptions:
                Visibility: HIDDEN
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            MaximumValue: 100.0
            MinimumValue: 0.0
            ParameterControlId: 5e4d2fb9-db69-4814-a5d4-2c85c1bac7ed
            SourceParameterName: BlockedGoal
            StepSize: 1.0
            Title: Blocked (%)
        - Slider:
            DisplayOptions:
              InfoIconLabelOptions:
                Visibility: HIDDEN
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            MaximumValue: 100.0
            MinimumValue: 1.0
            ParameterControlId: bd64c334-3bce-47e5-8d68-9dee130a5738
            SourceParameterName: PatchingGoal
            StepSize: 1.0
            Title: Patching Compliance
        - TextField:
            DisplayOptions:
              InfoIconLabelOptions:
                Visibility: HIDDEN
              PlaceholderOptions:
                Visibility: VISIBLE
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: 25110f1c-a6a1-41da-b679-f8832a6e6e21
            SourceParameterName: EC2DenialOfServiceDnsGoal
            Title: EC2 Denial Of Service DNS
        - TextField:
            DisplayOptions:
              PlaceholderOptions:
                Visibility: VISIBLE
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: 91022510-2de0-4e18-a5c5-37d79a363cfe
            SourceParameterName: EC2DenialOfServiceTcpGoal
            Title: EC2 Denial Of Service TCP
        - TextField:
            DisplayOptions:
              PlaceholderOptions:
                Visibility: VISIBLE
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: f9352b9a-ba5b-4722-889c-d4aa01602673
            SourceParameterName: EC2DenialOfServiceUdpGoal
            Title: EC2 Denial Of Service UDP
        - TextField:
            DisplayOptions:
              PlaceholderOptions:
                Visibility: VISIBLE
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: e56ad13f-ddda-4587-b953-ca14230f66af
            SourceParameterName: EC2DenialOfServiceUdpOnTcpPortsGoal
            Title: EC2 Denial Of Service UDP on TCP ports
        - TextField:
            DisplayOptions:
              PlaceholderOptions:
                Visibility: VISIBLE
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: 0e31a82b-451c-4583-8c28-a4d310c32995
            SourceParameterName: EC2DenialOfServiceUnusualProtocolGoal
            Title: EC2 Denial Of Service Unusual Protocol
        - TextField:
            DisplayOptions:
              PlaceholderOptions:
                Visibility: VISIBLE
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: a74840bd-b82d-4062-bbe7-47effa3ad8b8
            SourceParameterName: RDSAnomalousBehaviorSuccessfulBruteForceGoal
            Title: RDS Anomalous Behavior Successful Brute Force
        - TextField:
            DisplayOptions:
              PlaceholderOptions:
                Visibility: VISIBLE
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: 63f3d747-69b2-4082-931d-c2e097808fa7
            SourceParameterName: S3AnomalousBehaviorGoal
            Title: S3 Anomalous Behavior
        - TextField:
            DisplayOptions:
              PlaceholderOptions:
                Visibility: VISIBLE
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: 92bfab40-10cc-453d-99b0-e6ec4475cdf7
            SourceParameterName: S3MaliciousIPCallerCustomGoal
            Title: S3 Malicious IPCaller Custom
        - TextField:
            DisplayOptions:
              PlaceholderOptions:
                Visibility: VISIBLE
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: 62684e6c-285b-480c-8b1e-8c8c7bd265fe
            SourceParameterName: S3MaliciousIPCallerGoal
            Title: S3 Malicious IPCaller
        - TextField:
            DisplayOptions:
              PlaceholderOptions:
                Visibility: VISIBLE
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: 0add87ed-1bc7-4806-b187-cbe978a5f217
            SourceParameterName: EC2TrafficVolumeUnusualGoal
            Title: EC2 Traffic Volume Unusual
        - TextField:
            DisplayOptions:
              PlaceholderOptions:
                Visibility: VISIBLE
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: f2998949-712c-4b91-b6b6-98eb1c3a0e73
            SourceParameterName: RootCredentialUsageGoal
            Title: Root Credential Usage
        SheetControlLayouts:
        - Configuration:
            GridLayout:
              Elements: []
        SheetId: 9618fac8-155e-4b5f-b4d0-265b273c2e30
        TextBoxes:
        - Content: |-
            <text-box>
              <inline color="#7fd4b9" font-size="20px">
                <b>Patching Compliance KPIs</b>
              </inline>
            </text-box>
          SheetTextBoxId: f2ec651b-32c9-4654-885e-d2015cd867ce
        - Content: |-
            <text-box>
              <inline color="#7fd4b9" font-size="20px">
                <b>Amazon GuardDuty KPIs</b>
              </inline>
            </text-box>
          SheetTextBoxId: 176916bc-15de-4cc4-b55f-34189f920ef5
        - Content: "<text-box>\n  <inline font-size=\"22.4px\">\n    <b>Customize KPI Goals\_\
            </b>\n  </inline>\n  <br/>\n  <inline font-size=\"16px\">\n    <b>Use the slider\
            \ to customize KPI goals based on  your organization's requirements. KPIs are\
            \ defaulted to sample values.</b>\n  </inline>\n  <br/>\n  <b>\n    <i>Note:\_\
            </i>\n  </b>\n  <i>Sample KPIs goals provide a starting point of an attainable\
            \ goal and should be customized to your organization's targets.\_</i>\n</text-box>"
          SheetTextBoxId: 5fa2ac59-5ebf-4fc1-a7c6-71cdbd7f5b8a
        - Content: "<text-box>\n  <inline color=\"#7fd4b9\" font-size=\"20px\">\n    <b>AWS\
            \ WAF KPIs\_\_</b>\n  </inline>\n</text-box>"
          SheetTextBoxId: 8d47a9de-982d-43d4-bd4c-233fd231dd90
        Title: Set KPI Goals
        Visuals: []
      - ContentType: INTERACTIVE
        FilterControls:
        - DateTimePicker:
            DisplayOptions:
              DateTimeFormat: YYYY/MM/DD
              InfoIconLabelOptions:
                Visibility: HIDDEN
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            FilterControlId: d346646d-f313-4054-8b1e-a6a8b816bdb3
            SourceFilterId: 5655b4bc-aa26-4674-8fa2-b56fbaa19b45
            Title: Date
            Type: DATE_RANGE
        - Dropdown:
            DisplayOptions:
              InfoIconLabelOptions:
                Visibility: HIDDEN
              SelectAllOptions:
                Visibility: VISIBLE
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            FilterControlId: 10545e88-18a3-4f0a-8720-e011950cd517
            SourceFilterId: b0b5661c-3da0-4c91-8121-b8503c536e32
            Title: Action
            Type: MULTI_SELECT
        - Dropdown:
            DisplayOptions:
              InfoIconLabelOptions:
                Visibility: HIDDEN
              SelectAllOptions:
                Visibility: VISIBLE
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            FilterControlId: 959f70f2-2851-4171-b45f-a16bac454a18
            SourceFilterId: ccdb9fad-a1e2-4c71-bd8c-30d1d90cc669
            Title: Country
            Type: MULTI_SELECT
        - Dropdown:
            DisplayOptions:
              InfoIconLabelOptions:
                Visibility: HIDDEN
              SelectAllOptions:
                Visibility: VISIBLE
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            FilterControlId: c21b965d-29bd-4616-bcaf-1e21f90fac33
            SourceFilterId: 8fc88e72-45e2-4e87-8234-cb91296e1825
            Title: Client IP
            Type: MULTI_SELECT
        - Dropdown:
            DisplayOptions:
              InfoIconLabelOptions:
                Visibility: HIDDEN
              SelectAllOptions:
                Visibility: VISIBLE
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            FilterControlId: b9d325ce-5728-4744-92e9-d249241d2950
            SourceFilterId: f3206401-0fd4-43d5-99b1-c634612193bb
            Title: Web ACL
            Type: MULTI_SELECT
        - Dropdown:
            DisplayOptions:
              InfoIconLabelOptions:
                Visibility: HIDDEN
              SelectAllOptions:
                Visibility: VISIBLE
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            FilterControlId: b8080a01-e50d-4d5c-88d8-983923f198ba
            SourceFilterId: 117f533f-7e78-42e2-95af-6ca40763002f
            Title: Account ID
            Type: MULTI_SELECT
        Layouts:
        - Configuration:
            GridLayout:
              CanvasSizeOptions:
                ScreenCanvasSizeOptions:
                  OptimizedViewPortWidth: 1600px
                  ResizeOption: FIXED
              Elements:
              - ColumnIndex: 0
                ColumnSpan: 20
                ElementId: 21c1f1a3-4ca5-4823-a538-d00ef43b5760
                ElementType: VISUAL
                RowIndex: 0
                RowSpan: 10
              - ColumnIndex: 20
                ColumnSpan: 7
                ElementId: 9649009a-e221-42b0-8edd-8a7eb02a6cf5
                ElementType: VISUAL
                RowIndex: 0
                RowSpan: 5
              - ColumnIndex: 20
                ColumnSpan: 7
                ElementId: 4e98beea-6f01-4f65-afa2-16b63c5c56cf
                ElementType: VISUAL
                RowIndex: 5
                RowSpan: 5
              - ColumnIndex: 0
                ColumnSpan: 36
                ElementId: d4104db7-f027-47a6-a075-9e444c47204a
                ElementType: VISUAL
                RowIndex: 10
                RowSpan: 12
              - ColumnIndex: 0
                ColumnSpan: 18
                ElementId: 61d1476c-4314-44ac-8dd1-28024d6aace7
                ElementType: VISUAL
                RowIndex: 22
                RowSpan: 12
              - ColumnIndex: 18
                ColumnSpan: 18
                ElementId: e1f4c740-3f87-43a5-968c-ea57997ac69c
                ElementType: VISUAL
                RowIndex: 22
                RowSpan: 12
              - ColumnIndex: 0
                ColumnSpan: 18
                ElementId: df0f4940-e71a-481b-9c1f-ab078550623e
                ElementType: VISUAL
                RowIndex: 34
                RowSpan: 12
              - ColumnIndex: 18
                ColumnSpan: 18
                ElementId: f195696b-15dd-4e33-9428-1c8375d70cba
                ElementType: VISUAL
                RowIndex: 34
                RowSpan: 12
        Name: AWS WAF
        SheetControlLayouts:
        - Configuration:
            GridLayout:
              Elements:
              - ColumnIndex: 0
                ColumnSpan: 2
                ElementId: d346646d-f313-4054-8b1e-a6a8b816bdb3
                ElementType: FILTER_CONTROL
                RowIndex: 0
                RowSpan: 1
              - ColumnIndex: 2
                ColumnSpan: 2
                ElementId: 959f70f2-2851-4171-b45f-a16bac454a18
                ElementType: FILTER_CONTROL
                RowIndex: 0
                RowSpan: 1
              - ColumnIndex: 4
                ColumnSpan: 2
                ElementId: 10545e88-18a3-4f0a-8720-e011950cd517
                ElementType: FILTER_CONTROL
                RowIndex: 0
                RowSpan: 1
              - ColumnIndex: 6
                ColumnSpan: 2
                ElementId: c21b965d-29bd-4616-bcaf-1e21f90fac33
                ElementType: FILTER_CONTROL
                RowIndex: 0
                RowSpan: 1
              - ColumnIndex: 8
                ColumnSpan: 2
                ElementId: b9d325ce-5728-4744-92e9-d249241d2950
                ElementType: FILTER_CONTROL
                RowIndex: 0
                RowSpan: 1
              - ColumnSpan: 2
                ElementId: b8080a01-e50d-4d5c-88d8-983923f198ba
                ElementType: FILTER_CONTROL
                RowSpan: 1
        SheetId: 1244e012-61df-4baa-a257-22a1a4c8dbc9
        Title: AWS Web Application Firewall (WAF)
        Visuals:
        - FilledMapVisual:
            Actions: []
            ChartConfiguration:
              FieldWells:
                FilledMapAggregatedFieldWells:
                  Geospatial:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: country
                        DataSetIdentifier: kpi_waf
                      FieldId: f31988d8-85c3-4215-9698-969eb5f2e1ca.country.0.1685974133644
                  Values: []
              Legend:
                Width: 100px
              SortConfiguration: {}
              Tooltip:
                FieldBasedTooltip:
                  AggregationVisibility: HIDDEN
                  TooltipFields:
                  - FieldTooltipItem:
                      FieldId: f31988d8-85c3-4215-9698-969eb5f2e1ca.country.0.1685974133644
                      Visibility: VISIBLE
                  TooltipTitleType: PRIMARY_VALUE
                SelectedTooltipType: BASIC
                TooltipVisibility: VISIBLE
              WindowOptions:
                Bounds:
                  East: 333.08990852541535
                  North: 80.1058948654377
                  South: -45.40241695263384
                  West: -293.1916154613055
                MapZoomMode: MANUAL
            ColumnHierarchies: []
            Subtitle:
              FormatText:
                RichText: <visual-subtitle>Map with the source country of the requests.
                  If AWS WAF is unable to determine the country of origin, it sets this
                  field to -</visual-subtitle>
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: <visual-title>Country Request Map</visual-title>
              Visibility: VISIBLE
            VisualId: d4104db7-f027-47a6-a075-9e444c47204a
        - PieChartVisual:
            Actions: []
            ChartConfiguration:
              CategoryLabelOptions:
                SortIconVisibility: HIDDEN
                Visibility: HIDDEN
              DataLabels:
                Overlap: DISABLE_OVERLAP
                Visibility: VISIBLE
              DonutOptions:
                ArcOptions:
                  ArcThickness: MEDIUM
              FieldWells:
                PieChartAggregatedFieldWells:
                  Category:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: httpmethod
                        DataSetIdentifier: kpi_waf
                      FieldId: f31988d8-85c3-4215-9698-969eb5f2e1ca.httpmethod.0.1685997008542
                  Values: []
              Legend:
                Title:
                  CustomLabel: HTTP Method
              SortConfiguration:
                CategoryItemsLimit:
                  OtherCategories: INCLUDE
                CategorySort:
                - FieldSort:
                    Direction: DESC
                    FieldId: f31988d8-85c3-4215-9698-969eb5f2e1ca.httpmethod.0.1685997008542
                SmallMultiplesLimitConfiguration:
                  OtherCategories: INCLUDE
              Tooltip:
                FieldBasedTooltip:
                  AggregationVisibility: HIDDEN
                  TooltipFields:
                  - FieldTooltipItem:
                      FieldId: f31988d8-85c3-4215-9698-969eb5f2e1ca.httpmethod.0.1685997008542
                      Visibility: VISIBLE
                  TooltipTitleType: PRIMARY_VALUE
                SelectedTooltipType: BASIC
                TooltipVisibility: VISIBLE
            ColumnHierarchies: []
            Subtitle:
              FormatText:
                RichText: <visual-subtitle>HTTP method in the requests</visual-subtitle>
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: <visual-title>HTTP Methods</visual-title>
              Visibility: VISIBLE
            VisualId: 61d1476c-4314-44ac-8dd1-28024d6aace7
        - BarChartVisual:
            Actions: []
            ChartConfiguration:
              BarsArrangement: CLUSTERED
              CategoryAxis:
                ScrollbarOptions:
                  VisibleRange:
                    PercentRange:
                      From: 77.34899328859075
                      To: 87.41610738255048
              CategoryLabelOptions:
                SortIconVisibility: HIDDEN
                Visibility: HIDDEN
              DataLabels:
                Overlap: DISABLE_OVERLAP
                Visibility: HIDDEN
              FieldWells:
                BarChartAggregatedFieldWells:
                  Category:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: clientip
                        DataSetIdentifier: kpi_waf
                      FieldId: f31988d8-85c3-4215-9698-969eb5f2e1ca.clientip.0.1685997063111
                  Colors: []
                  Values: []
              Orientation: HORIZONTAL
              SortConfiguration:
                CategoryItemsLimit:
                  OtherCategories: INCLUDE
                ColorItemsLimit:
                  OtherCategories: INCLUDE
                SmallMultiplesLimitConfiguration:
                  OtherCategories: INCLUDE
              Tooltip:
                FieldBasedTooltip:
                  AggregationVisibility: HIDDEN
                  TooltipFields:
                  - FieldTooltipItem:
                      FieldId: f31988d8-85c3-4215-9698-969eb5f2e1ca.clientip.0.1685997063111
                      Visibility: VISIBLE
                  TooltipTitleType: PRIMARY_VALUE
                SelectedTooltipType: BASIC
                TooltipVisibility: VISIBLE
            ColumnHierarchies: []
            Subtitle:
              FormatText:
                RichText: <visual-subtitle>IP address of the clients sending the request</visual-subtitle>
              Visibility: VISIBLE
            Title:
              Visibility: VISIBLE
            VisualId: e1f4c740-3f87-43a5-968c-ea57997ac69c
        - PieChartVisual:
            Actions: []
            ChartConfiguration:
              DataLabels:
                Overlap: DISABLE_OVERLAP
                Visibility: VISIBLE
              DonutOptions:
                ArcOptions:
                  ArcThickness: MEDIUM
              FieldWells:
                PieChartAggregatedFieldWells:
                  Category:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: action
                        DataSetIdentifier: kpi_waf
                      FieldId: f31988d8-85c3-4215-9698-969eb5f2e1ca.action.0.1686061526865
                  Values: []
              SortConfiguration:
                CategoryItemsLimit:
                  OtherCategories: INCLUDE
                SmallMultiplesLimitConfiguration:
                  OtherCategories: INCLUDE
              Tooltip:
                FieldBasedTooltip:
                  AggregationVisibility: HIDDEN
                  TooltipFields:
                  - FieldTooltipItem:
                      FieldId: f31988d8-85c3-4215-9698-969eb5f2e1ca.action.0.1686061526865
                      Visibility: VISIBLE
                  TooltipTitleType: PRIMARY_VALUE
                SelectedTooltipType: BASIC
                TooltipVisibility: VISIBLE
            ColumnHierarchies: []
            Subtitle:
              FormatText:
                RichText: <visual-subtitle>Summary of allowed vs blocked requests</visual-subtitle>
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: <visual-title>Summary Actions</visual-title>
              Visibility: VISIBLE
            VisualId: 21c1f1a3-4ca5-4823-a538-d00ef43b5760
        - BarChartVisual:
            Actions: []
            ChartConfiguration:
              BarsArrangement: CLUSTERED
              CategoryLabelOptions:
                SortIconVisibility: HIDDEN
                Visibility: HIDDEN
              DataLabels:
                Overlap: DISABLE_OVERLAP
                Visibility: HIDDEN
              FieldWells:
                BarChartAggregatedFieldWells:
                  Category:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: terminatingruleid
                        DataSetIdentifier: kpi_waf
                      FieldId: f31988d8-85c3-4215-9698-969eb5f2e1ca.terminatingruleid.0.1686061558361
                  Colors: []
                  Values: []
              Orientation: HORIZONTAL
              SortConfiguration:
                CategoryItemsLimit:
                  OtherCategories: INCLUDE
                ColorItemsLimit:
                  OtherCategories: INCLUDE
                SmallMultiplesLimitConfiguration:
                  OtherCategories: INCLUDE
              Tooltip:
                FieldBasedTooltip:
                  AggregationVisibility: HIDDEN
                  TooltipFields:
                  - FieldTooltipItem:
                      FieldId: f31988d8-85c3-4215-9698-969eb5f2e1ca.terminatingruleid.0.1686061558361
                      Visibility: VISIBLE
                  TooltipTitleType: PRIMARY_VALUE
                SelectedTooltipType: BASIC
                TooltipVisibility: VISIBLE
              ValueAxis:
                AxisOffset: 100px
                TickLabelOptions:
                  LabelOptions:
                    Visibility: VISIBLE
            ColumnHierarchies: []
            Subtitle:
              FormatText:
                RichText: <visual-subtitle>Rules that terminated requests (blocked)</visual-subtitle>
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: <visual-title>Terminating Rule</visual-title>
              Visibility: VISIBLE
            VisualId: f195696b-15dd-4e33-9428-1c8375d70cba
        - BarChartVisual:
            Actions: []
            ChartConfiguration:
              BarsArrangement: STACKED
              CategoryLabelOptions:
                SortIconVisibility: HIDDEN
                Visibility: HIDDEN
              DataLabels:
                Overlap: DISABLE_OVERLAP
                Visibility: HIDDEN
              FieldWells:
                BarChartAggregatedFieldWells:
                  Category:
                  - DateDimensionField:
                      Column:
                        ColumnName: timestamp
                        DataSetIdentifier: kpi_waf
                      FieldId: f31988d8-85c3-4215-9698-969eb5f2e1ca.timestamp.0.1686069782758
                      HierarchyId: 4b803f52-3bcd-47ab-aee3-bfa4c296996d
                  Colors:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: action
                        DataSetIdentifier: kpi_waf
                      FieldId: f31988d8-85c3-4215-9698-969eb5f2e1ca.action.1.1686069903938
                  Values: []
              Orientation: VERTICAL
              SortConfiguration:
                CategoryItemsLimit:
                  OtherCategories: INCLUDE
                CategorySort:
                - FieldSort:
                    Direction: ASC
                    FieldId: f31988d8-85c3-4215-9698-969eb5f2e1ca.timestamp.0.1686069782758
                ColorItemsLimit:
                  OtherCategories: INCLUDE
                SmallMultiplesLimitConfiguration:
                  OtherCategories: INCLUDE
              Tooltip:
                FieldBasedTooltip:
                  AggregationVisibility: HIDDEN
                  TooltipFields:
                  - FieldTooltipItem:
                      FieldId: f31988d8-85c3-4215-9698-969eb5f2e1ca.timestamp.0.1686069782758
                      Visibility: VISIBLE
                  - FieldTooltipItem:
                      FieldId: f31988d8-85c3-4215-9698-969eb5f2e1ca.action.1.1686069903938
                      Visibility: VISIBLE
                  TooltipTitleType: PRIMARY_VALUE
                SelectedTooltipType: BASIC
                TooltipVisibility: VISIBLE
              ValueAxis:
                TickLabelOptions:
                  LabelOptions:
                    Visibility: VISIBLE
            ColumnHierarchies:
            - DateTimeHierarchy:
                DrillDownFilters: []
                HierarchyId: 4b803f52-3bcd-47ab-aee3-bfa4c296996d
            Subtitle:
              FormatText:
                RichText: <visual-subtitle>Timeline with number of requests allowed and
                  blocked on a daily basis</visual-subtitle>
              Visibility: VISIBLE
            Title:
              Visibility: VISIBLE
            VisualId: df0f4940-e71a-481b-9c1f-ab078550623e
        - KPIVisual:
            Actions: []
            ChartConfiguration:
              FieldWells:
                TargetValues: []
                TrendGroups: []
                Values:
                - NumericalMeasureField:
                    AggregationFunction:
                      SimpleNumericalAggregation: SUM
                    Column:
                      ColumnName: allowed
                      DataSetIdentifier: kpi_waf
                    FieldId: 753d0076-f6e6-4212-bb39-5887653e9cc5.0.1686069980396
              SortConfiguration: {}
            ColumnHierarchies: []
            Subtitle:
              FormatText:
                RichText: <visual-subtitle>Number of requests allowed</visual-subtitle>
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: |-
                  <visual-title>
                    <inline font-size="16px">Total Allowed</inline>
                  </visual-title>
              Visibility: VISIBLE
            VisualId: 9649009a-e221-42b0-8edd-8a7eb02a6cf5
        - KPIVisual:
            Actions: []
            ChartConfiguration:
              FieldWells:
                TargetValues: []
                TrendGroups: []
                Values:
                - NumericalMeasureField:
                    AggregationFunction:
                      SimpleNumericalAggregation: SUM
                    Column:
                      ColumnName: blocked
                      DataSetIdentifier: kpi_waf
                    FieldId: c5996e15-de43-46a3-bc77-419557fd773e.0.1686069982876
              SortConfiguration: {}
            ColumnHierarchies: []
            Subtitle:
              FormatText:
                RichText: <visual-subtitle>Number of requests blocked</visual-subtitle>
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: |-
                  <visual-title>
                    <inline font-size="16px">Total Blocked</inline>
                  </visual-title>
              Visibility: VISIBLE
            VisualId: 4e98beea-6f01-4f65-afa2-16b63c5c56cf
      - ContentType: INTERACTIVE
        FilterControls:
        - DateTimePicker:
            DisplayOptions:
              DateTimeFormat: YYYY/MM/DD
              InfoIconLabelOptions:
                Visibility: HIDDEN
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            FilterControlId: 5d877c04-93f8-494e-91e5-5e07ceb0fb14
            SourceFilterId: a02083e4-91d0-4f61-b897-2d1162190f16
            Title: Creation Date
            Type: DATE_RANGE
        - Dropdown:
            DisplayOptions:
              InfoIconLabelOptions:
                Visibility: HIDDEN
              SelectAllOptions:
                Visibility: VISIBLE
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            FilterControlId: e0b2915e-7f05-44b4-ada6-efba064d687e
            SourceFilterId: 3ef4714e-6a2a-428e-9c6f-58bb414a0981
            Title: Account ID
            Type: MULTI_SELECT
        Layouts:
        - Configuration:
            GridLayout:
              CanvasSizeOptions:
                ScreenCanvasSizeOptions:
                  OptimizedViewPortWidth: 1600px
                  ResizeOption: FIXED
              Elements:
              - ColumnIndex: 0
                ColumnSpan: 18
                ElementId: b2e91b91-36a6-4f74-b2e8-25d5b3e81139
                ElementType: VISUAL
                RowIndex: 0
                RowSpan: 12
              - ColumnIndex: 18
                ColumnSpan: 18
                ElementId: 61ccdc1b-0630-40cb-9573-58310a30999e
                ElementType: VISUAL
                RowIndex: 0
                RowSpan: 12
              - ColumnIndex: 0
                ColumnSpan: 36
                ElementId: e56bd055-cefd-4ae7-8847-eaf9f7eca9ad
                ElementType: VISUAL
                RowIndex: 12
                RowSpan: 12
              - ColumnIndex: 0
                ColumnSpan: 30
                ElementId: db800143-2f6f-477b-b7e8-63553af5b8d7
                ElementType: VISUAL
                RowIndex: 24
                RowSpan: 12
        Name: Amazon GuardDuty
        SheetControlLayouts:
        - Configuration:
            GridLayout:
              Elements:
              - ColumnSpan: 2
                ElementId: 5d877c04-93f8-494e-91e5-5e07ceb0fb14
                ElementType: FILTER_CONTROL
                RowSpan: 1
              - ColumnSpan: 2
                ElementId: e0b2915e-7f05-44b4-ada6-efba064d687e
                ElementType: FILTER_CONTROL
                RowSpan: 1
        SheetId: 0d8daf3f-54a7-44bc-8058-ac19c3a30558
        Title: Amazon GuardDuty
        Visuals:
        - LineChartVisual:
            Actions: []
            ChartConfiguration:
              DataLabels:
                Overlap: DISABLE_OVERLAP
                Visibility: HIDDEN
              FieldWells:
                LineChartAggregatedFieldWells:
                  Category:
                  - DateDimensionField:
                      Column:
                        ColumnName: createdat
                        DataSetIdentifier: kpi_guardduty
                      FieldId: cd6b1e69-2afc-4f72-bc24-7e913d4da97b.createdat.0.1685991479802
                      HierarchyId: d115ef0f-baf7-4779-a6d9-afbc8da33b37
                  Colors: []
                  Values: []
              SortConfiguration:
                CategoryItemsLimitConfiguration:
                  OtherCategories: INCLUDE
                ColorItemsLimitConfiguration:
                  OtherCategories: INCLUDE
                SmallMultiplesLimitConfiguration:
                  OtherCategories: INCLUDE
              Tooltip:
                FieldBasedTooltip:
                  AggregationVisibility: HIDDEN
                  TooltipFields:
                  - FieldTooltipItem:
                      FieldId: cd6b1e69-2afc-4f72-bc24-7e913d4da97b.createdat.0.1685991479802
                      Visibility: VISIBLE
                  TooltipTitleType: PRIMARY_VALUE
                SelectedTooltipType: BASIC
                TooltipVisibility: VISIBLE
              Type: LINE
              XAxisLabelOptions:
                AxisLabelOptions:
                - ApplyTo:
                    Column:
                      ColumnName: createdat
                      DataSetIdentifier: kpi_guardduty
                    FieldId: cd6b1e69-2afc-4f72-bc24-7e913d4da97b.createdat.0.1685991479802
                  CustomLabel: Create Date
            ColumnHierarchies:
            - DateTimeHierarchy:
                DrillDownFilters: []
                HierarchyId: d115ef0f-baf7-4779-a6d9-afbc8da33b37
            Subtitle:
              FormatText:
                RichText: <visual-subtitle>Timeline with the number of findings on a daily
                  basis</visual-subtitle>
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: <visual-title>Finding Timeline</visual-title>
              Visibility: VISIBLE
            VisualId: b2e91b91-36a6-4f74-b2e8-25d5b3e81139
        - PieChartVisual:
            Actions: []
            ChartConfiguration:
              CategoryLabelOptions:
                SortIconVisibility: HIDDEN
                Visibility: HIDDEN
              DataLabels:
                Overlap: DISABLE_OVERLAP
                Visibility: VISIBLE
              DonutOptions:
                ArcOptions:
                  ArcThickness: WHOLE
              FieldWells:
                PieChartAggregatedFieldWells:
                  Category:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: type
                        DataSetIdentifier: kpi_guardduty
                      FieldId: cd6b1e69-2afc-4f72-bc24-7e913d4da97b.type.0.1685991608907
                  Values:
                  - CategoricalMeasureField:
                      AggregationFunction: COUNT
                      Column:
                        ColumnName: id
                        DataSetIdentifier: kpi_guardduty
                      FieldId: cd6b1e69-2afc-4f72-bc24-7e913d4da97b.id.1.1685991618902
              Legend:
                Width: 138px
              SortConfiguration:
                CategoryItemsLimit:
                  OtherCategories: INCLUDE
                CategorySort:
                - FieldSort:
                    Direction: DESC
                    FieldId: cd6b1e69-2afc-4f72-bc24-7e913d4da97b.id.1.1685991618902
                SmallMultiplesLimitConfiguration:
                  OtherCategories: INCLUDE
              Tooltip:
                FieldBasedTooltip:
                  AggregationVisibility: HIDDEN
                  TooltipFields:
                  - FieldTooltipItem:
                      FieldId: cd6b1e69-2afc-4f72-bc24-7e913d4da97b.type.0.1685991608907
                      Visibility: VISIBLE
                  - FieldTooltipItem:
                      FieldId: cd6b1e69-2afc-4f72-bc24-7e913d4da97b.id.1.1685991618902
                      Visibility: VISIBLE
                  TooltipTitleType: PRIMARY_VALUE
                SelectedTooltipType: BASIC
                TooltipVisibility: VISIBLE
              ValueLabelOptions:
                SortIconVisibility: HIDDEN
                Visibility: HIDDEN
            ColumnHierarchies: []
            Subtitle:
              FormatText:
                RichText: <visual-subtitle>Summary by finding type of activity that triggered
                  the finding</visual-subtitle>
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: <visual-title>Finding Types</visual-title>
              Visibility: VISIBLE
            VisualId: 61ccdc1b-0630-40cb-9573-58310a30999e
        - BarChartVisual:
            Actions: []
            ChartConfiguration:
              BarsArrangement: STACKED
              CategoryAxis:
                ScrollbarOptions:
                  VisibleRange:
                    PercentRange:
                      From: 80.3921568627451
                      To: 100.0
              DataLabels:
                Overlap: DISABLE_OVERLAP
                Visibility: HIDDEN
              FieldWells:
                BarChartAggregatedFieldWells:
                  Category:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: accountid
                        DataSetIdentifier: kpi_guardduty
                      FieldId: cd6b1e69-2afc-4f72-bc24-7e913d4da97b.accountid.0.1685991679741
                  Colors:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: type
                        DataSetIdentifier: kpi_guardduty
                      FieldId: cd6b1e69-2afc-4f72-bc24-7e913d4da97b.type.1.1685991690990
                  Values: []
              Legend:
                Position: AUTO
                Title:
                  Visibility: VISIBLE
                Visibility: VISIBLE
                Width: 276px
              Orientation: HORIZONTAL
              SortConfiguration:
                CategoryItemsLimit:
                  OtherCategories: INCLUDE
                CategorySort:
                - ColumnSort:
                    AggregationFunction:
                      CategoricalAggregationFunction: COUNT
                    Direction: DESC
                    SortBy:
                      ColumnName: type
                      DataSetIdentifier: kpi_guardduty
                ColorItemsLimit:
                  OtherCategories: INCLUDE
                SmallMultiplesLimitConfiguration:
                  OtherCategories: INCLUDE
              Tooltip:
                FieldBasedTooltip:
                  AggregationVisibility: HIDDEN
                  TooltipFields:
                  - FieldTooltipItem:
                      FieldId: cd6b1e69-2afc-4f72-bc24-7e913d4da97b.accountid.0.1685991679741
                      Visibility: VISIBLE
                  - FieldTooltipItem:
                      FieldId: cd6b1e69-2afc-4f72-bc24-7e913d4da97b.type.1.1685991690990
                      Visibility: VISIBLE
                  - FieldTooltipItem:
                      FieldId: cd6b1e69-2afc-4f72-bc24-7e913d4da97b.type.1.1685991690990
                      Visibility: VISIBLE
                  TooltipTitleType: PRIMARY_VALUE
                SelectedTooltipType: BASIC
                TooltipVisibility: VISIBLE
            ColumnHierarchies: []
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: <visual-title>Summary by Account IDs</visual-title>
              Visibility: VISIBLE
            VisualId: db800143-2f6f-477b-b7e8-63553af5b8d7
        - TableVisual:
            Actions: []
            ChartConfiguration:
              FieldOptions:
                Order: []
                SelectedFieldOptions:
                - CustomLabel: Type
                  FieldId: cd6b1e69-2afc-4f72-bc24-7e913d4da97b.type.0.1686332798992
                  Width: 316px
                - CustomLabel: Title
                  FieldId: cd6b1e69-2afc-4f72-bc24-7e913d4da97b.title.2.1686332798992
                  Width: 676px
                - CustomLabel: Description
                  FieldId: cd6b1e69-2afc-4f72-bc24-7e913d4da97b.description.1.1686332798992
              FieldWells:
                TableAggregatedFieldWells:
                  GroupBy:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: type
                        DataSetIdentifier: kpi_guardduty
                      FieldId: cd6b1e69-2afc-4f72-bc24-7e913d4da97b.type.0.1686332798992
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: title
                        DataSetIdentifier: kpi_guardduty
                      FieldId: cd6b1e69-2afc-4f72-bc24-7e913d4da97b.title.2.1686332798992
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: description
                        DataSetIdentifier: kpi_guardduty
                      FieldId: cd6b1e69-2afc-4f72-bc24-7e913d4da97b.description.1.1686332798992
                  Values: []
              SortConfiguration: {}
              TableOptions:
                CellStyle:
                  Height: 25
                HeaderStyle:
                  Height: 24
                  TextWrap: WRAP
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: <visual-title>Findings details</visual-title>
              Visibility: VISIBLE
            VisualId: e56bd055-cefd-4ae7-8847-eaf9f7eca9ad
      - ContentType: INTERACTIVE
        FilterControls:
        - DateTimePicker:
            DisplayOptions:
              DateTimeFormat: YYYY/MM/DD
              InfoIconLabelOptions:
                Visibility: HIDDEN
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            FilterControlId: 4c952915-4378-41c5-8092-c31a4078fe10
            SourceFilterId: dd027afa-d3e5-460a-a140-e58cc21f8ee5
            Title: Report Date
            Type: DATE_RANGE
        - Dropdown:
            DisplayOptions:
              InfoIconLabelOptions:
                Visibility: HIDDEN
              SelectAllOptions:
                Visibility: VISIBLE
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            FilterControlId: 6f81e479-5379-4e41-8b0b-fd0c586ed230
            SourceFilterId: 3b02be53-4134-4133-9bac-3603b9f822f7
            Title: Account ID
            Type: MULTI_SELECT
        Layouts:
        - Configuration:
            GridLayout:
              CanvasSizeOptions:
                ScreenCanvasSizeOptions:
                  OptimizedViewPortWidth: 1600px
                  ResizeOption: FIXED
              Elements:
              - ColumnIndex: 0
                ColumnSpan: 36
                ElementId: e54d8f23-4d7e-4b6d-98c1-dd76db21d69a
                ElementType: VISUAL
                RowIndex: 0
                RowSpan: 12
              - ColumnIndex: 0
                ColumnSpan: 17
                ElementId: 52626454-29dc-4b06-9667-6ef0e9de7f05
                ElementType: VISUAL
                RowIndex: 12
                RowSpan: 12
              - ColumnIndex: 17
                ColumnSpan: 18
                ElementId: db0ad15b-d8a7-42c6-8b95-101eb32dec4a
                ElementType: VISUAL
                RowIndex: 12
                RowSpan: 12
        Name: Patching Compliance
        SheetControlLayouts:
        - Configuration:
            GridLayout:
              Elements:
              - ColumnSpan: 2
                ElementId: 4c952915-4378-41c5-8092-c31a4078fe10
                ElementType: FILTER_CONTROL
                RowSpan: 1
              - ColumnSpan: 2
                ElementId: 6f81e479-5379-4e41-8b0b-fd0c586ed230
                ElementType: FILTER_CONTROL
                RowSpan: 1
        SheetId: a75f7fbe-8ba9-48fc-8e65-4a6556d2a568
        Title: Patching Compliance
        Visuals:
        - BarChartVisual:
            Actions: []
            ChartConfiguration:
              BarsArrangement: STACKED
              CategoryLabelOptions:
                AxisLabelOptions:
                - ApplyTo:
                    Column:
                      ColumnName: report_date
                      DataSetIdentifier: kpi_patching
                    FieldId: d299c153-0a02-4d5c-b7e2-17571c2459fe.compliance_status.0.1686061636315
                  CustomLabel: Report Date
              DataLabels:
                Overlap: DISABLE_OVERLAP
                Visibility: HIDDEN
              FieldWells:
                BarChartAggregatedFieldWells:
                  Category:
                  - DateDimensionField:
                      Column:
                        ColumnName: report_date
                        DataSetIdentifier: kpi_patching
                      FieldId: d299c153-0a02-4d5c-b7e2-17571c2459fe.compliance_status.0.1686061636315
                      HierarchyId: 63f5d58e-76c3-478c-be8a-d392715f8941
                  Colors:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: compliance_status
                        DataSetIdentifier: kpi_patching
                      FieldId: d299c153-0a02-4d5c-b7e2-17571c2459fe.compliance_status.1.1686061680701
                  Values: []
              Legend:
                Width: 150px
              Orientation: VERTICAL
              SortConfiguration:
                CategoryItemsLimit:
                  OtherCategories: INCLUDE
                CategorySort:
                - FieldSort:
                    Direction: DESC
                    FieldId: d299c153-0a02-4d5c-b7e2-17571c2459fe.compliance_status.0.1686061636315
                ColorItemsLimit:
                  OtherCategories: INCLUDE
                SmallMultiplesLimitConfiguration:
                  OtherCategories: INCLUDE
              Tooltip:
                FieldBasedTooltip:
                  AggregationVisibility: HIDDEN
                  TooltipFields:
                  - FieldTooltipItem:
                      FieldId: d299c153-0a02-4d5c-b7e2-17571c2459fe.compliance_status.0.1686061636315
                      Visibility: VISIBLE
                  - FieldTooltipItem:
                      FieldId: d299c153-0a02-4d5c-b7e2-17571c2459fe.compliance_status.1.1686061680701
                      Visibility: VISIBLE
                  TooltipTitleType: PRIMARY_VALUE
                SelectedTooltipType: BASIC
                TooltipVisibility: VISIBLE
            ColumnHierarchies:
            - DateTimeHierarchy:
                DrillDownFilters: []
                HierarchyId: 63f5d58e-76c3-478c-be8a-d392715f8941
            Subtitle:
              FormatText:
                RichText: <visual-subtitle>Timeline with the number of compliant instances
                  in each report date</visual-subtitle>
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: <visual-title>Summary</visual-title>
              Visibility: VISIBLE
            VisualId: e54d8f23-4d7e-4b6d-98c1-dd76db21d69a
        - TableVisual:
            Actions: []
            ChartConfiguration:
              FieldOptions:
                Order: []
                SelectedFieldOptions:
                - CustomLabel: Account ID
                  FieldId: d299c153-0a02-4d5c-b7e2-17571c2459fe.account_id.3.1698158214029
                - CustomLabel: Region
                  FieldId: d299c153-0a02-4d5c-b7e2-17571c2459fe.region.4.1698158219819
                - CustomLabel: Instance ID
                  FieldId: d299c153-0a02-4d5c-b7e2-17571c2459fe.instance_id.4.1686332087056
                - CustomLabel: Patch Group
                  FieldId: d299c153-0a02-4d5c-b7e2-17571c2459fe.patch_group.2.1686332051093
                  Width: 185px
                - CustomLabel: Status
                  FieldId: d299c153-0a02-4d5c-b7e2-17571c2459fe.compliance_status.0.1686331991791
                  Width: 128px
              FieldWells:
                TableAggregatedFieldWells:
                  GroupBy:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: account_id
                        DataSetIdentifier: kpi_patching
                      FieldId: d299c153-0a02-4d5c-b7e2-17571c2459fe.account_id.3.1698158214029
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: region
                        DataSetIdentifier: kpi_patching
                      FieldId: d299c153-0a02-4d5c-b7e2-17571c2459fe.region.4.1698158219819
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: instance_id
                        DataSetIdentifier: kpi_patching
                      FieldId: d299c153-0a02-4d5c-b7e2-17571c2459fe.instance_id.4.1686332087056
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: patch_group
                        DataSetIdentifier: kpi_patching
                      FieldId: d299c153-0a02-4d5c-b7e2-17571c2459fe.patch_group.2.1686332051093
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: compliance_status
                        DataSetIdentifier: kpi_patching
                      FieldId: d299c153-0a02-4d5c-b7e2-17571c2459fe.compliance_status.0.1686331991791
                  Values: []
              SortConfiguration: {}
              TableOptions:
                HeaderStyle:
                  Height: 25
                  TextWrap: WRAP
            Subtitle:
              FormatText:
                RichText: <visual-subtitle>Instance details reported on in the observed
                  reporting period</visual-subtitle>
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: <visual-title>Report details filtered by Report Date</visual-title>
              Visibility: VISIBLE
            VisualId: 52626454-29dc-4b06-9667-6ef0e9de7f05
        - BarChartVisual:
            Actions: []
            ChartConfiguration:
              BarsArrangement: STACKED
              CategoryLabelOptions:
                AxisLabelOptions:
                - ApplyTo:
                    Column:
                      ColumnName: account_id
                      DataSetIdentifier: kpi_patching
                    FieldId: d299c153-0a02-4d5c-b7e2-17571c2459fe.account_id.0.1698158338267
                  CustomLabel: Account ID
                Visibility: HIDDEN
              DataLabels:
                Overlap: DISABLE_OVERLAP
                Visibility: HIDDEN
              FieldWells:
                BarChartAggregatedFieldWells:
                  Category:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: account_id
                        DataSetIdentifier: kpi_patching
                      FieldId: d299c153-0a02-4d5c-b7e2-17571c2459fe.account_id.0.1698158338267
                  Colors: []
                  Values: []
              Orientation: HORIZONTAL
              SortConfiguration:
                CategoryItemsLimit:
                  OtherCategories: INCLUDE
                ColorItemsLimit:
                  OtherCategories: INCLUDE
                SmallMultiplesLimitConfiguration:
                  OtherCategories: INCLUDE
              Tooltip:
                FieldBasedTooltip:
                  AggregationVisibility: HIDDEN
                  TooltipFields:
                  - FieldTooltipItem:
                      FieldId: d299c153-0a02-4d5c-b7e2-17571c2459fe.account_id.0.1698158338267
                      Visibility: VISIBLE
                  TooltipTitleType: PRIMARY_VALUE
                SelectedTooltipType: DETAILED
                TooltipVisibility: VISIBLE
            ColumnHierarchies: []
            Subtitle:
              FormatText:
                RichText: <visual-subtitle>Compliance status grouped by Account ID</visual-subtitle>
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: <visual-title>Compliance Status by Account ID</visual-title>
              Visibility: VISIBLE
            VisualId: db0ad15b-d8a7-42c6-8b95-101eb32dec4a
datasets:
  kpi_guardduty:
    data:
      DataSetId: 453819c8-a7b1-405a-8044-59f2aed066bc
      Name: kpi_guardduty
      PhysicalTableMap:
        16458581-2c39-4b83-b328-142096706dd9:
          RelationalTable:
            DataSourceArn: ${athena_datasource_arn}
            Catalog: AwsDataCatalog
            Schema: ${athena_database_name}
            Name: kpi_guardduty
            InputColumns:
            - Name: schemaversion
              Type: STRING
            - Name: accountid
              Type: STRING
            - Name: region
              Type: STRING
            - Name: partition
              Type: STRING
            - Name: id
              Type: STRING
            - Name: arn
              Type: STRING
            - Name: type
              Type: STRING
            - Name: resource
              Type: STRING
            - Name: service
              Type: STRING
            - Name: severity
              Type: STRING
            - Name: createdat
              Type: DATETIME
            - Name: updatedat
              Type: DATETIME
            - Name: title
              Type: STRING
            - Name: description
              Type: STRING
      LogicalTableMap:
        b3d80249-f523-497c-bfe9-8188c90d6229:
          Alias: kpi_guardduty
          DataTransforms:
          - TagColumnOperation:
              ColumnName: region
              Tags:
              - ColumnGeographicRole: STATE
          Source:
            PhysicalTableId: 16458581-2c39-4b83-b328-142096706dd9
      ImportMode: SPICE
    dependsOn:
      views:
      - kpi_guardduty
    schedules:
    - default
  kpi_patching:
    data:
      DataSetId: ffc7b180-72db-4b8d-89b7-2f6690587082
      Name: kpi_patching
      PhysicalTableMap:
        855ce9fe-4b3d-4d7a-94cb-598b595b71c6:
          RelationalTable:
            DataSourceArn: ${athena_datasource_arn}
            Catalog: AwsDataCatalog
            Schema: ${athena_database_name}
            Name: kpi_patching
            InputColumns:
            - Name: report_date
              Type: DATETIME
            - Name: instance_id
              Type: STRING
            - Name: patch_baseline
              Type: STRING
            - Name: patch_group
              Type: STRING
            - Name: compliance_status
              Type: STRING
            - Name: compliance_severity
              Type: STRING
            - Name: account_id
              Type: STRING
            - Name: region
              Type: STRING
      LogicalTableMap:
        d299c153-0a02-4d5c-b7e2-17571c2459fe:
          Alias: kpi_patching
          DataTransforms:
          - ProjectOperation:
              ProjectedColumns:
              - report_date
              - instance_id
              - patch_baseline
              - patch_group
              - compliance_status
              - compliance_severity
              - account_id
              - region
          Source:
            PhysicalTableId: 855ce9fe-4b3d-4d7a-94cb-598b595b71c6
      ImportMode: SPICE
    dependsOn:
      views:
      - kpi_patching
    schedules:
    - default
  kpi_waf:
    data:
      DataSetId: 4323a7a3-5eeb-42bc-b952-8dc76257c589
      Name: kpi_waf
      PhysicalTableMap:
        3ba25ba1-5388-494b-b706-cbed049ab336:
          RelationalTable:
            DataSourceArn: ${athena_datasource_arn}
            Catalog: AwsDataCatalog
            Schema: ${athena_database_name}
            Name: kpi_waf
            InputColumns:
            - Name: timestamp
              Type: DATETIME
            - Name: webaclid
              Type: STRING
            - Name: terminatingruleid
              Type: STRING
            - Name: action
              Type: STRING
            - Name: httpsourcename
              Type: STRING
            - Name: httpsourceid
              Type: STRING
            - Name: clientip
              Type: STRING
            - Name: country
              Type: STRING
            - Name: httpmethod
              Type: STRING
            - Name: accountid
              Type: STRING
      LogicalTableMap:
        f31988d8-85c3-4215-9698-969eb5f2e1ca:
          Alias: kpi_waf
          DataTransforms:
          - TagColumnOperation:
              ColumnName: country
              Tags:
              - ColumnGeographicRole: COUNTRY
          - ProjectOperation:
              ProjectedColumns:
              - timestamp
              - webaclid
              - terminatingruleid
              - action
              - httpsourcename
              - httpsourceid
              - clientip
              - country
              - httpmethod
              - accountid
          Source:
            PhysicalTableId: 3ba25ba1-5388-494b-b706-cbed049ab336
      ImportMode: SPICE
    dependsOn:
      views:
      - kpi_waf
    schedules:
    - default
views:
  kpi_guardduty:
    data: |-
      CREATE OR REPLACE VIEW ${athena_database_name}.kpi_guardduty AS
      SELECT *
      FROM
        kpi_guardduty_logs
      WHERE ("createdat" >= ("date_trunc"('month', current_timestamp) - INTERVAL  '6' MONTH))
  kpi_patching:
    data: |-
      CREATE OR REPLACE VIEW ${athena_database_name}.kpi_patching AS
      SELECT
        CAST(from_iso8601_timestamp(executiontime) AS DATE) "report_date"
      , "resourceid" "instance_id"
      , "patchbaselineid" "patch_baseline"
      , "patchgroup" "patch_group"
      , "status" "compliance_status"
      , "overallseverity" "compliance_severity"
      , "accountid" "account_id"
      , "region" "region"
      FROM
        kpi_patch_reports
      WHERE ((compliancetype = 'Patch') AND (executiontime <> '') AND (CAST(date_format(CAST(from_iso8601_timestamp(executiontime) AS DATE), '%m') AS integer) >= (month(current_timestamp) - 6)))
  kpi_waf:
    data: |-
      CREATE OR REPLACE VIEW ${athena_database_name}.kpi_waf AS
      SELECT
        CAST(from_unixtime((CAST("timestamp" AS bigint) / 1000)) AS DATE) "timestamp"
      , SPLIT_PART(webaclid, 'webacl/', 2) "webaclid"
      , terminatingruleid
      , action
      , httpsourcename
      , httpsourceid
      , httprequest.clientip
      , httprequest.country
      , httprequest.httpmethod
      , accountid
      FROM
        kpi_waf_logs
      WHERE ((timestamp <> '') AND (CAST(month AS integer) >= (month(current_timestamp) - 6)))
